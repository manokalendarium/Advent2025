<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"> <title>Mama Kalend√°riuma</title>
    
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <style>
        :root {
            --ios-blue: #007AFF;
            --ios-gray: #262629;
            --ios-bg: #000000;
            --ios-text: #FFFFFF;
            --ios-gray-text: #8E8E93;
            --glass: rgba(30, 30, 30, 0.6);
            --glass-border: rgba(255, 255, 255, 0.15);
            --royal-gold: #FFD700;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        /* MOBIL OPTIMALIZ√ÅL√ÅS: SAFE AREA KEZEL√âS */
        body { 
            margin: 0; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: #000; color: white; overflow: hidden; height: 100vh; width: 100vw;
            /* FELS≈ê P√ÅRN√ÅZ√ÅS A NOTCH (Kamera) MIATT */
            padding-top: constant(safe-area-inset-top); 
            padding-top: env(safe-area-inset-top); 
        }

        /* --- H√ÅTT√âR & EFFEKTEK --- */
        .background {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: radial-gradient(circle at top left, #1a1a2e, #000);
        }
        .orb {
            position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.4;
            animation: float 15s infinite ease-in-out alternate;
        }
        .orb-1 { width: 300px; height: 300px; background: #007AFF; top: -50px; left: -50px; }
        .orb-2 { width: 400px; height: 400px; background: #5E5CE6; bottom: -100px; right: -100px; animation-delay: -5s; }
        
        @keyframes float { 0% { transform: translate(0,0); } 100% { transform: translate(40px, 60px); } }

        /* H√ìES√âS */
        .snowflake { position: absolute; background: white; border-radius: 50%; opacity: 0.7; pointer-events: none; animation: fall linear infinite; }
        @keyframes fall { to { transform: translateY(105vh); } }

        /* --- F≈ê TART√ÅLY --- */
        #app-root { height: 100%; display: flex; justify-content: center; }
        .app-screen {
            width: 100%; max-width: 480px; height: 100%; 
            display: flex; flex-direction: column; position: relative;
            background: rgba(0,0,0,0.2);
            overflow: hidden;
        }

        /* --- API KULCS MODAL --- */
        .api-modal {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 999; display: flex; align-items: center; justify-content: center;
        }
        .api-card {
            width: 85%; background: #1C1C1E; padding: 30px; border-radius: 24px; text-align: center; border: 1px solid #333;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
        }
        .api-input {
            width: 100%; padding: 12px; margin: 15px 0; background: #2C2C2E; border: 1px solid #444; border-radius: 12px; color: white; font-size: 16px;
            outline: none;
        }
        
        /* --- HEADER, GRID, TAB BAR (GRID VIEW) --- */
        .grid-view-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .header {
            /* FELS≈ê R√âSZ LEJJebb MOZD√çT√ÅSA: 20px-r≈ël 35px-re n√∂velve */
            padding: 35px 20px 20px 20px; 
            text-align: center; position: relative; z-index: 10;
        }
        .app-title {
            font-size: 12px; letter-spacing: 2px; text-transform: uppercase; color: rgba(255,255,255,0.5); margin-bottom: 5px;
        }
        .main-title {
            font-size: 28px; font-weight: 800;
            background: linear-gradient(135deg, #fff, #ccc); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 4px 20px rgba(255,255,255,0.3);
        }
        .countdown {
            font-family: monospace; font-size: 11px; background: rgba(255,255,255,0.1); 
            padding: 4px 8px; border-radius: 6px; display: inline-block; margin-top: 8px;
            border: 1px solid rgba(255,255,255,0.1); color: var(--royal-gold);
        }
        .grid-container {
            flex: 1; overflow-y: auto; padding: 20px;
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;
            align-content: start;
        }
        .grid-container::-webkit-scrollbar { display: none; }
        .day-card {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative; cursor: pointer;
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .day-card:active { transform: scale(0.92); background: rgba(255,255,255,0.15); }
        .day-card.locked { opacity: 0.4; pointer-events: none; background: rgba(0,0,0,0.3); border-color: rgba(255,255,255,0.05); }
        
        .day-num { font-size: 20px; font-weight: 700; }
        .status-icon { font-size: 24px; }
        
        .day-card.opened {
            background: rgba(0, 122, 255, 0.2);
            border-color: rgba(0, 122, 255, 0.5);
            box-shadow: 0 0 20px rgba(0, 122, 255, 0.3);
        }
        
        /* ALS√ì S√ÅV OPTIMALIZ√ÅL√ÅSA */
        .tab-bar {
            background: rgba(20, 20, 20, 0.85); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255,255,255,0.1);
            padding: 10px 30px; /* Alap p√°rn√°z√°s */
            padding-bottom: calc(10px + constant(safe-area-inset-bottom)); /* P√°rn√°z√°s a gesztus s√°v al√° */
            padding-bottom: calc(10px + env(safe-area-inset-bottom));
            display: flex; justify-content: space-around;
        }
        .tab-item {
            display: flex; flex-direction: column; align-items: center; gap: 4px;
            color: #888; cursor: pointer; transition: color 0.2s; position: relative;
        }
        .tab-item.active { color: #007AFF; }
        .tab-icon { font-size: 24px; }
        .tab-label { font-size: 10px; font-weight: 500; }
        .badge {
            position: absolute; top: -2px; right: -5px;
            background: #FF3B30; color: white; font-size: 10px; font-weight: bold;
            min-width: 16px; height: 16px; border-radius: 8px;
            display: flex; align-items: center; justify-content: center; padding: 2px;
        }

        /* --- MESE MODAL --- */
        .modal-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
            z-index: 50; display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: opacity 0.2s;
        }
        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }
        .story-card {
            width: 85%; max-height: 80%; background: #1C1C1E; 
            border-radius: 24px; padding: 24px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
            border: 1px solid rgba(255,255,255,0.1);
            display: flex; flex-direction: column;
            transform: scale(0.8); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-overlay.active .story-card {
            transform: scale(1);
        }
        .story-title { font-size: 22px; font-weight: 700; margin-bottom: 15px; color: white; text-align: center; }
        .story-text { 
            font-size: 17px; line-height: 1.5; color: #ddd; overflow-y: auto; flex: 1; margin-bottom: 5px; 
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            text-align: justify; padding-right: 5px;
        }
        .story-text p { margin: 1em 0; }
        .story-btn {
            background: #007AFF; color: white; border: none; padding: 10px;
            border-radius: 14px; font-size: 15px; font-weight: 600; width: 100%; cursor: pointer;
            transition: all 0.1s;
        }
        .story-btn:active { transform: scale(0.98); }
        .dot-indicator {
            width: 8px; height: 8px; border-radius: 50%; background: #444; transition: background 0.3s;
        }
        .dot-indicator.active { background: #007AFF; }

        /* --- CHAT K√âPERNY≈êK --- */
        .chat-screen-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 100;
            display: flex; flex-direction: column;
            transform: translateX(100%); transition: transform 0.3s ease-out;
        }
        .chat-screen-container.active {
            transform: translateX(0);
        }
        
        .chat-header {
            background: rgba(20, 20, 20, 0.85); backdrop-filter: blur(20px);
            padding: 15px 10px; display: flex; align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1); z-index: 20;
        }
        .back-btn { color: #007AFF; font-size: 17px; display: flex; align-items: center; gap: 5px; cursor: pointer; }
        .chat-avatar-header {
            display: flex; flex-direction: column; align-items: center; flex: 1; margin-right: 40px;
        }
        .header-avatar { font-size: 24px; margin-bottom: 2px; transition: transform 0.2s; cursor: pointer; }
        .header-avatar:active { transform: scale(1.2); }
        .header-name { font-size: 12px; color: #fff; font-weight: 500; }
        .chat-body {
            flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 8px;
            padding-bottom: 80px;
            scroll-behavior: smooth; 
        }
        .message-row { display: flex; width: 100%; margin-bottom: 4px; opacity: 0; animation: fadeIn 0.3s forwards; }
        .message-row.me { justify-content: flex-end; }
        .message-row.them { justify-content: flex-start; align-items: flex-end; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .avatar-small { width: 30px; height: 30px; border-radius: 50%; background: #333; display: flex; align-items: center; justify-content: center; font-size: 16px; margin-right: 8px; }
        
        /* K√âP √úZENET ST√çLUS */
        .bubble.image-bubble {
            background: none; 
            padding: 0; 
            border-radius: 20px 20px 20px 4px;
            overflow: hidden;
            max-width: 75%;
        }
        .bubble.image-bubble img {
            max-width: 100%;
            display: block;
            border-radius: 12px; 
            filter: brightness(0.95);
        }

        .bubble {
            max-width: 75%; padding: 10px 16px; font-size: 17px; line-height: 1.4; position: relative;
        }
        .bubble.me {
            background: #007AFF; color: white; border-radius: 20px 20px 4px 20px;
        }
        .bubble.them {
            background: #262628; color: white; border-radius: 20px 20px 20px 4px;
        }
        
        /* CHAT INPUT BAR OPTIMALIZ√ÅL√ÅSA */
        .chat-input-bar {
            position: absolute; bottom: 0; width: 100%;
            background: rgba(20, 20, 20, 0.9); backdrop-filter: blur(20px);
            padding: 10px 15px; /* Alap p√°rn√°z√°s */
            padding-bottom: calc(10px + constant(safe-area-inset-bottom)); /* P√°rn√°z√°s a gesztus s√°v al√° */
            padding-bottom: calc(10px + env(safe-area-inset-bottom));
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex; align-items: center; gap: 10px;
        }
        .ios-input {
            flex: 1; background: #1C1C1E; border: 1px solid #333;
            border-radius: 20px; padding: 8px 15px; color: white; font-size: 17px; outline: none;
        }
        .send-circle {
            width: 30px; height: 30px; background: #007AFF; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; color: white; font-size: 16px; cursor: pointer;
            transition: all 0.2s; 
        }
        .send-circle.disabled { background: #444; color: #888; pointer-events: none; }
        .typing-bubble {
            background: #262628; padding: 12px 16px; border-radius: 20px; width: fit-content;
            display: flex; gap: 4px; align-items: center; margin-left: 38px; border-bottom-left-radius: 4px;
        }
        .dot { width: 6px; height: 6px; background: #8E8E93; border-radius: 50%; animation: bounce 1.4s infinite ease-in-out both; }
        .dot:nth-child(1) { animation-delay: -0.32s; } .dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        .reply-chips { display: flex; gap: 8px; padding: 10px 15px; overflow-x: auto; background: rgba(20, 20, 20, 0.9); border-top: 1px solid rgba(255,255,255,0.1); }
        .chip { background: #1C1C1E; color: #007AFF; border: 1px solid #007AFF; padding: 8px 16px; border-radius: 20px; font-size: 15px; white-space: nowrap; cursor: pointer; transition: background 0.1s; }
        .chip:active { background: #007AFF; color: white; }
        
        /* --- iOS NOTIFICATION --- */
        .notification-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 200;
        }
        .ios-notification {
            position: absolute; top: 10px; left: 10px; right: 10px;
            background: rgba(30, 30, 30, 0.85); backdrop-filter: blur(25px);
            border-radius: 18px; padding: 12px;
            pointer-events: auto; cursor: pointer;
            animation: notifSlide 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .notif-icon {
            width: 40px; height: 40px; background: #333; border-radius: 10px;
            display: flex; align-items: center; justify-content: center; font-size: 22px;
        }
        .notif-content { flex: 1; }
        .notif-header { display: flex; justify-content: space-between; margin-bottom: 2px; }
        .notif-title { font-weight: 600; font-size: 14px; color: white; }
        .notif-msg { font-size: 14px; color: #fff; line-height: 1.2; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

        @keyframes notifSlide { from { transform: translateY(-100px); } to { transform: translateY(0); } }
        
        .test-btn { position: absolute; top: 20px; left: 20px; font-size: 24px; opacity: 0.3; cursor: pointer; z-index: 10; }
        
    </style>
</head>
<body>
    <div id="app-root">
        <div class="app-screen">
            <div class="background">
                <div class="orb orb-1"></div>
                <div class="orb orb-2"></div>
            </div>
            <div id="api-modal" class="api-modal" style="display:none;">
                <div class="api-card">
                    <div style="font-size:40px">üîë</div>
                    <h2>Szia!</h2>
                    <p>K√©rlek add meg a Gemini API kulcsodat, hogy a pl√ºss√∂k tudjanak besz√©lni!</p>
                    <input id="api-input" class="api-input" placeholder="M√°sold ide a kulcsot..." type="text" />
                    <button id="api-save-btn" class="story-btn">Ment√©s √©s Ind√≠t√°s</button>
                </div>
            </div>
            
            <div id="test-btn" class="test-btn">‚öôÔ∏è</div>

            <div id="notification-container" class="notification-container">
                </div>

            <div id="grid-view" class="grid-view-container">
                <div class="header">
                    <div class="app-title">MAMA KALEND√ÅRIUMA</div>
                    <div class="main-title">2025</div>
                    <div id="countdown" class="countdown"></div>
                </div>
                <div id="grid-container" class="grid-container">
                    </div>
                <div class="tab-bar">
                    <div id="tab-grid" class="tab-item active"><i class="bi bi-grid-fill tab-icon"></i><span class="tab-label">Napt√°r</span></div>
                    <div id="tab-chat" class="tab-item"><div style="position:relative"><i class="bi bi-chat-fill tab-icon"></i><div id="unread-badge" class="badge" style="display:none;"></div></div><span class="tab-label">√úzenetek</span></div>
                </div>
            </div>

            <div id="story-modal" class="modal-overlay">
                <div class="story-card">
                    <div id="story-title" class="story-title"></div>
                    
                    <div id="story-page-1" class="story-text story-page"></div> 
                    <div id="story-page-2" class="story-text story-page" style="display:none;"></div>
                    
                    <div id="story-nav" style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
                        <button id="story-prev-btn" class="story-btn" style="width:45%; background:rgba(255,255,255,0.1); color:#fff;"><i class="bi bi-chevron-left"></i> El≈ëz≈ë</button>
                        <div id="story-dots" style="display:flex; gap:8px;">
                            <span id="dot-1" class="dot-indicator active"></span>
                            <span id="dot-2" class="dot-indicator"></span>
                        </div>
                        <button id="story-next-btn" class="story-btn" style="width:45%;">K√∂vetkez≈ë <i class="bi bi-chevron-right"></i></button>
                    </div>

                    <button id="story-close-btn" class="story-btn" style="margin-top:15px;">Bez√°r√°s</button>
                </div>
            </div>

            <div id="chat-screen-list" class="chat-screen-container">
                <div class="chat-header" style="justify-content:center; position:relative;">
                    <div style="font-weight:bold; font-size:17;">√úzenetek</div>
                    <div id="chat-list-close-btn" style="position:absolute; left:15px; color:#007AFF; cursor:pointer;">Bez√°r√°s</div>
                </div>
                <div id="chat-list-body" class="chat-body" style="padding:0; padding-top:10px;">
                    </div>
            </div>

            <div id="chat-screen-detail" class="chat-screen-container">
                <div class="chat-header">
                    <div id="chat-detail-back-btn" class="back-btn"><i class="bi bi-chevron-left"></i> Vissza</div>
                    <div id="chat-detail-avatar-header" class="chat-avatar-header">
                        <div id="chat-detail-icon" class="header-avatar"></div>
                        <div id="chat-detail-name" class="header-name"></div>
                    </div>
                    <div style="width:50px;"></div>
                </div>
                <div id="chat-detail-body" class="chat-body">
                    </div>
                <div id="reply-chips" class="reply-chips" style="display:none;">
                    </div>
                <div class="chat-input-bar">
                    <input id="chat-input" class="ios-input" placeholder="iMessage" type="text" />
                    <div id="chat-send-circle" class="send-circle disabled"><i class="bi bi-arrow-up"></i></div>
                </div>
            </div>

        </div>
    </div>
    
    <script>
        // --- √ÅLLAND√ìK √âS ADATOK ---
        const ELEMENTS = {
            gridContainer: document.getElementById('grid-container'),
            gridView: document.getElementById('grid-view'),
            storyModal: document.getElementById('story-modal'),
            storyTitle: document.getElementById('story-title'),
            storyPage1: document.getElementById('story-page-1'), 
            storyPage2: document.getElementById('story-page-2'), 
            storyPrevBtn: document.getElementById('story-prev-btn'),
            storyNextBtn: document.getElementById('story-next-btn'),
            storyDot1: document.getElementById('dot-1'),
            storyDot2: document.getElementById('dot-2'),
            storyCloseBtn: document.getElementById('story-close-btn'), 
            countdown: document.getElementById('countdown'),
            unreadBadge: document.getElementById('unread-badge'),
            tabGrid: document.getElementById('tab-grid'),
            tabChat: document.getElementById('tab-chat'),
            apiModal: document.getElementById('api-modal'),
            apiInput: document.getElementById('api-input'),
            apiSaveBtn: document.getElementById('api-save-btn'),
            notificationContainer: document.getElementById('notification-container'),
            chatScreenList: document.getElementById('chat-screen-list'),
            chatScreenDetail: document.getElementById('chat-screen-detail'),
            chatListBody: document.getElementById('chat-list-body'),
            chatDetailBody: document.getElementById('chat-detail-body'),
            chatInput: document.getElementById('chat-input'),
            chatSendCircle: document.getElementById('chat-send-circle'),
            replyChips: document.getElementById('reply-chips'),
            chatDetailIcon: document.getElementById('chat-detail-icon'),
            chatDetailName: document.getElementById('chat-detail-name'),
            testBtn: document.getElementById('test-btn'),
        };

        const CHARACTERS = {
            hanna: { name: "Hanna", icon: "üéÄ", desc: "r√≥zsasz√≠n, gondoskod√≥ l√°ny v√≠zil√≥", style: "Kedves, any√°skod√≥, sok emojit haszn√°l.", key: "hanna" },
            herold: { name: "Herold", icon: "ü¶õ", desc: "lila, puf√≥k √©s fal√°nk v√≠zil√≥", style: "Vicces, √©hes, szeleburdi.", key: "herold" },
            bucko: { name: "Buck√≥", icon: "üê≥", desc: "k√©k, b√°tor kis b√°lna", style: "B√°tor, lelkes, vizet emleget.", key: "bucko" }
        };

        const CHAT_CONTACTS = [
            CHARACTERS.hanna,
            CHARACTERS.herold,
            CHARACTERS.bucko,
        ];
        
        // --- FRISS√çTETT STORY DATA K√âT R√âSZRE OSZTVA, HOSSZABB √úZENETEKKEL √©s K√âP ADATOKKAL ---
        const STORY_DATA = [
            // 1. HANNA (Gondoskod√≥) - A nagy elutaz√°s
            { 
                id: 1, 
                char: "hanna", 
                title: "A nagy elutaz√°s", 
                storyPage1: "A reggel k√∂d√∂sen indult, a leveg≈ëben m√°r √©rezni lehetett a t√©l illat√°t. Papa √©s Mama √≥ri√°si b≈ër√∂nd√∂ket cipeltek ki az aut√≥hoz. Herold coc√≥ az ablakban √°llt, √©s az orr√°t az √ºveghez nyomta, amit≈ël az egy kicsit lapos √©s vicces lett. Egy apr√≥ k√∂nnycsepp csillogott a szem√©ben. ‚Äì Ne szomorkodj, Herold! ‚Äì l√©pett oda hozz√° Hanna coc√≥, √©s b√°tran √°t√∂lelte testv√©r√©t. ‚Äì Mienk az eg√©sz h√°z, azt csin√°lunk, amit akarunk!", 
                storyPage2: "Ekkor megjelent Buck√≥, a kis b√°lna, fej√©n egy ford√≠tott t√©sztasz≈±r≈ëvel, ami √∫gy n√©zett ki, mint egy sisak. ‚Äì Jelentem, a b√°zis v√©delm√©t √°tvettem! ‚Äì harsogta m√©ly hangj√°n. ‚Äì Senki nem l√©phet be enged√©ly n√©lk√ºl, csak a post√°s, ha hoz csomagot! Papa √©s Mama meg√≠g√©rt√©k: kar√°csonyra, mire az els≈ë csillag felj√∂n, itthon lesznek.", 
                storyImageText: "N√©zd, √©pp most k√©sz√≠tettem egy k√©pet, ahogy integet√ºnk!", // K√©p bevezet≈ë sz√∂vege
                storyImageUrl: "placeholder_day1.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Szia Mama! Rem√©lem, k√©nyelmes az utaz√°sotok! ‚ù§Ô∏è Ne agg√≥dj egy percet sem, Herold is eg√©szen megnyugodott, miut√°n megkapta a m√°sodik √∂lel√©st. Nagyon √ºgyesek vagyunk itthon, √©s felel≈ëss√©gteljesen vigy√°zunk a h√°zra √©s Buck√≥ra is. Vigy√°zz magadra, √©s puszilunk nagyon! üéÄ", 
                    "K√©sz√≠tettem neked egy kis csomagot az √∫tra. Haszn√°ld ezt a Mini k√©zkr√©met, hogy puha maradjon a kezed!"
                ], 
                replies: [{u: "K√∂sz√∂n√∂m, Hanna! ‚ù§Ô∏è", c: "Sz√≠vesen! Most megyek, seg√≠tek Heroldnak kipakolni. Szia! üëã"}, {u: "Ti is vigy√°zzatok!", c: "√çg√©rj√ºk! Na szaladok! Szia!"}]
            },
            // 2. BUCK√ì (B√°tor, lelkes) - Az els≈ë csendes este
            { 
                id: 2, 
                char: "bucko", 
                title: "Az els≈ë csendes este", 
                storyPage1: "Furcsa volt a h√°z a sz√ºl≈ëk n√©lk√ºl. Valahogy minden √°rny√©k nagyobbnak t≈±nt, √©s a padl√≥ is hangosabban recsegett, mintha l√©pkedne valaki. ‚Äì Szerintetek a szellem, aki a padl√°son lakik, szereti a kaka√≥t? ‚Äì k√©rdezte Herold vacsora k√∂zben remeg≈ë hangon, √©s a takar√≥ja al√° b√∫jt. ‚Äì Nincs is szellem, csak a sz√©l z√∂rgeti a cserepeket! ‚Äì nyugtatta meg Hanna, b√°r ≈ë is s≈±r≈±bben pislogott a s√∂t√©t folyos√≥ fel√©.", 
                storyPage2: "Buck√≥ nem f√©lt. ≈ê a f√ºrd≈ëk√°dban rendezte be a f≈ëhadisz√°ll√°s√°t, mert hi√°nyzott neki a tenger. ‚Äì A v√≠zben jobban terjed a hang! ‚Äì magyar√°zta a t√∂bbieknek. ‚Äì Ha bet√∂r≈ë j√∂n, azonnal jelezni fogok: csapkodni fogok a farkammal, j√≥ hangosan! V√©g√ºl mindh√°rman a f√ºrd≈ëszoba sz≈ënyeg√©n aludtak el, a cs√∂p√∂g≈ë csap megnyugtat√≥ ritmus√°ra.", 
                storyImageText: "N√©zd, √©pp most k√©sz√≠tettem egy k√©pet a f≈ëhadisz√°ll√°sr√≥l!",
                storyImageUrl: "placeholder_day2.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Jelentem a Mama Kalend√°rium√°ba: a h√°z teljesen biztons√°gos! A f√ºrd≈ëk√°dban alv√°s a legbiztosabb megold√°s, onnan mindent hallok, ami a h√°zban t√∂rt√©nik, √©s a recseg≈ë padl√≥ sem tud meglepni! Ne agg√≥dj Mama, minden a legnagyobb rendben! üê≥", 
                    "Hogy te is nyugodtan aludj, k√ºld√∂k neked egy kis Levendul√°s p√°rnapermentet. Sz√©p √°lmokat!"
                ], 
                replies: [{u: "J√≥ √©jt, Buck√≥! üåô", c: "Neked is! Megyek csobbanok egyet a b√°zison. Sz√©p √°lmokat! üõÅ"}, {u: "B√°tor vagy!", c: "K√∂szi! A tenger ereje velem van! Szia! ü´ß"}] 
            },
            // 3. HANNA (Rendrak√≥) - A lila palacsinta party
            { 
                id: 3, 
                char: "hanna", 
                title: "A lila palacsinta party", 
                storyPage1: "‚Äì Ma √©n vagyok a szak√°cs! ‚Äì jelentette ki Hanna coc√≥ m√°snap reggel, √©s felk√∂t√∂tte Mama legnagyobb k√∂t√©ny√©t, amiben k√©tszer is elf√©rt volna. √ögy d√∂nt√∂ttek, palacsint√°t s√ºtnek. De nem ak√°rmilyet! Herold lila √©telfest√©ket csemp√©szett a t√©szt√°ba, Hanna pedig r√≥zsasz√≠n cukork√°kat sz√≥rt bele.", 
                storyPage2: "‚Äì Hopp! ‚Äì Hanna feldobta az els≈ë palacsint√°t, de az nem esett le. ‚Äì Hova t≈±nt? ‚Äì k√©rdezte Herold. Mindketten feln√©ztek: a lila t√©szta r√°tapadt a plafonra, mint egy furcsa csill√°r. Buck√≥ speci√°lis, s√≥s palacsint√°t k√©rt, de mivel nem volt alga otthon, spen√≥ttal helyettes√≠tett√©k. A v√©g√©n a konyha √∫gy n√©zett ki, mintha felrobbannt volna egy sziv√°rv√°nygy√°r, de a palacsinta isteni finom volt!", 
                storyImageText: "N√©zd, mi lett az els≈ë palacsint√°b√≥l! üòÖ",
                storyImageUrl: "placeholder_day3.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Bocsi, Mama, a konyh√°√©rt... üòÖ Kicsit elszaladt vel√ºnk a palacsinta-fant√°zia, √©s igen, lila lett a plafon. De √≠g√©rj√ºk, holnap egy nagy takar√≠t√≥ hadm≈±veletet ind√≠tunk, √©s nyoma sem marad a lila katasztr√≥f√°nak! Rem√©lem, neked jobban telik a napod, mint nek√ºnk a nagytakar√≠t√°s! üéÄ", 
                    "Ha m√°r mi √∂sszekent√ºk magunkat, te kend be az arcodat ezzel a finom Kr√©mArcmaszkkal. J√≥t fog tenni!"
                ], 
                replies: [{u: "J√≥l sz√≥raztok! üòÑ", c: "Nagyon! Palacsint√°t m√©g! Szia! üòú"}, {u: "A plafonon m√©g van?", c: "Igen! De m√°r k√∂zel a takar√≠t√°s! Szia!"}]
            },
            // 4. HEROLD (Szeleburdi) - A nagy takar√≠t√≥ hadm≈±velet
            { 
                id: 4, 
                char: "herold", 
                title: "A nagy takar√≠t√≥ hadm≈±velet", 
                storyPage1: "M√°snap reggel sz√∂rny≈± l√°tv√°ny fogadta ≈ëket a konyh√°ban. A tegnapi palacsint√°z√°s nyomai mindenhol ott √©ktelenkedtek. A liszt √∫gy sz√°llt a leveg≈ëben, mint a h√≥es√©s, a padl√≥ pedig ragadt a szirupt√≥l. ‚Äì Ezt nem hagyhatjuk √≠gy, mit sz√≥lnak majd Any√°√©k? ‚Äì s√≥hajtott Hanna. Herold el≈ëhozta a porsz√≠v√≥t, amit 'Sz√∂rnyetegnek' h√≠vott, mert mindig megpr√≥b√°lta bekapni a l√°bujj√°t.", 
                storyPage2: "Buck√≥ v√°llalta a felmos√°st. Telet√∂lt√∂tte a sz√°j√°t v√≠zzel, √©s mint egy kis t≈±zolt√≥aut√≥, v√©gigspriccelte a k√∂vet. ‚Äì Buck√≥! Ez nem medenc√©s buli! ‚Äì ki√°ltotta Herold, mik√∂zben elcs√∫szott egy t√≥cs√°ban, √©s v√©gigsz√°nk√°zott a nappalin. D√©lut√°nra m√©gis csillogott-villogott minden. M√©g a plafonr√≥l is lekapart√°k a r√°sz√°radt palacsint√°t.", 
                storyImageText: "N√©zd, √≠gy n√©z ki, amikor sz√°nk√°zunk a nappaliban! üòÖ",
                storyImageUrl: "placeholder_day4.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama! Ma √©n voltam a porsz√≠v√≥-kir√°ly! üëë B√°r elcs√∫sztam Buck√≥ felmos√≥-t√≥cs√°j√°ban √©s sz√°nk√≥ztam egyet a nappaliban, de a h√°z ragyog! A plafon is tiszta lett. Olyan f√°raszt√≥ volt, hogy most egy √≥r√°t pihenni fogok. B√ºszke lenn√©l r√°nk! Rem√©lem, te is pihensz egy kicsit a sok munka k√∂zben. ü¶õ", 
                    "Neked csak a pihen√©s maradt: itt van egy Micell√°s v√≠z, hogy az arcod is olyan tiszta legyen, mint a padl√≥nk!"
                ], 
                replies: [{u: "J√≥l siker√ºlt a sz√°nk√≥?", c: "A l√°bamnak nem annyira, de a sz√≥rakoz√°s 10/10! Szia! üòú"}, {u: "Mi az a Sz√∂rnyeteg?", c: "A porsz√≠v√≥! Mindig meg akar enni! Szia!"}]
            },
            // 5. BUCK√ì (Kalandor) - Kincsvad√°szat a padl√°son
            { 
                id: 5, 
                char: "bucko", 
                title: "Kincsvad√°szat a padl√°son", 
                storyPage1: "Az es≈ë esett, √≠gy nem mehettek ki az udvarra. Felmentek a padl√°sra, ahol a r√©gi dobozok k√∂z√∂tt kutattak. A porcic√°k t√°ncot j√°rtak a besz≈±r≈ëd≈ë f√©nyben. ‚Äì N√©zz√©tek! ‚Äì ki√°ltotta Buck√≥. ‚Äì Ez egy igazi kal√≥zt√©rk√©p! Egy megs√°rgult pap√≠r volt az, amin furcsa vonalak kanyorogtak a nappali alaprajz√°n. ‚Äì Itt az X! A kanap√© alatt! ‚Äì suttogta izgatottan Herold. ‚Äì Biztosan aranyat rejt!", 
                storyPage2: "Lemosakodtak a f√∂ldszintre, √©s hason cs√∫szva, l√°mp√°ssal a k√©zben bek√∫sztak a kanap√© al√°. Kincsesl√°da helyett tal√°ltak: k√©t elveszettnek hitt leg√≥kock√°t, egy mogyor√≥t √©s Papa f√©l p√°r papucs√°t, amit m√°r tavaly √≥ta keresett. ‚Äì Ez a papucs √©rt√©kesebb b√°rmilyen aranyn√°l! Papa nagyon √∂r√ºlni fog! ‚Äì √°llap√≠totta meg b√∂lcsen Hanna.", 
                storyImageText: "N√©zd, elk√©sz√≠tettem a kincst√©rk√©p fot√≥j√°t!",
                storyImageUrl: "placeholder_day5.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "K√©pzeld Mama! Tal√°ltunk egy igazi kincset, kalandor m√≥dj√°ra, a padl√°son √©s a kanap√© alatt! üè¥‚Äç‚ò†Ô∏è J√≥, nem aranyat, hanem Papa f√©l p√°r papucs√°t, de szerintem ez m√©g √©rt√©kesebb! F≈ëleg, hogy tavaly √≥ta keresi! J√≥l elf√°radtunk a nagy b√∫j√°sban! üê≥", 
                    "De neked tal√°ltunk igazi aranyat! Tedd fel ezt az Arany szemmaszkot, √©s ragyogj!"
                ], 
                replies: [{u: "Micsoda kincsek! ü§£", c: "A papucs a legnagyobb tr√≥fea! Szia! ü•á"}, {u: "Vigy√°zzatok a padl√°son!", c: "Teljesen biztons√°gos! A porcic√°k is kedvesek! Szia!"}]
            },
            // 6. HANNA (Gondoskod√≥) - K√©sz√ºl≈ëd√©s a Mikul√°sra
            { 
                id: 6, 
                char: "hanna", 
                title: "K√©sz√ºl≈ëd√©s a Mikul√°sra", 
                storyPage1: "December 5-e est√©je volt. A legfontosabb feladat v√°rt r√°juk: a cip≈ëpucol√°s. Herold a legnagyobb t√©li bakancs√°t vette el≈ë, √©s addig d√∂rzs√∂lte, am√≠g l√°tni nem lehetett benne az arc√°t. ‚Äì Ebbe sok csoki f√©r! ‚Äì kacsintott. Hanna a legcsinosabb lakkcip≈ëj√©t f√©nyes√≠tette ronggyal.", 
                storyPage2: "De mi legyen Buck√≥val? Neki nincs l√°ba, √≠gy cip≈ëje sincs. Szomor√∫an l√≥gatta az orr√°t. ‚Äì Ne b√∫sulj, Buck√≥! ‚Äì mondta Hanna. ‚Äì Itt van a felmos√≥v√∂d√∂r! Kitiszt√≠tjuk, √©s ez lesz a te csizm√°d! Este mindh√°rman az ablakba tett√©k a l√°bbeliket (√©s a v√∂dr√∂t), majd izgatottan figyelt√©k az eget. ‚Äì Szerintetek a r√©nszarvasok tudnak √∫szni? ‚Äì k√©rdezte Buck√≥ √°s√≠tva, miel≈ëtt elnyomta az √°lom.", 
                storyImageText: "N√©zd, ez a v√∂d√∂r lesz Buck√≥ csizm√°ja! üòâ",
                storyImageUrl: "placeholder_day6.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Kif√©nyes√≠tett√ºk az √∂sszes cip≈ët! ‚ú® Nagyon izgatottak vagyunk, alig v√°rjuk a reggelt! Ne agg√≥dj Buck√≥ miatt, neki adtuk a felmos√≥v√∂dr√∂t, √∫gy gondoltuk, az a legalkalmasabb egy b√°ln√°nak. Szerinted a Mikul√°s hoz neki abba is aj√°nd√©kot? Rem√©lem! Drukkolj nek√ºnk! üéÄ", 
                    "Itt az ideje, hogy a te k√∂rmeid is ragyogjanak! K√ºld√ºnk egy sz√©p K√∂r√∂mlakkot az √ºnnepekre. üíÖ"
                ], 
                replies: [{u: "Micsoda csapatmunka! ü•∞", c: "Igen! K√ºl√∂nleges csizm√°k! Szia! üòä"}, {u: "Melyikbe f√©r a legt√∂bb csoki?", c: "Herold bakancs√°ba! De Buck√≥√© a legviccesebb! Szia!"}]
            },
            // 7. BUCK√ì (V√≠zi √©lm√©ny) - Mit hozott a T√©lap√≥?
            { 
                id: 7, 
                char: "bucko", 
                title: "Mit hozott a T√©lap√≥?", 
                storyPage1: "Reggel m√©g a nap sem kelt fel, de Herold m√°r kiugrott az √°gyb√≥l. ‚Äì Itt j√°rt! ITT J√ÅRT! ‚Äì vis√≠totta, √©s berontott a nappaliba. A bakancsok tele voltak finoms√°ggal. Herold kapott egy zacsk√≥ lila gumicukrot √©s egy kis aut√≥t. Hanna cip≈ëj√©ben csillog√≥ hajcsatok √©s mogyor√≥s csoki lapult.", 
                storyPage2: "√âs Buck√≥ v√∂dre? Az volt a legnehezebb! Tele volt v√≠zi-j√°t√©kokkal √©s egy hatalmas csomag gumihallal. ‚Äì M√©gis tudta! ‚Äì ujjongott Buck√≥, √©s belevetette mag√°t a v√∂d√∂rbe. ‚Äì Tudta, hogy itt lakik egy b√°lna! Eg√©sz d√©lel≈ëtt csokit ettek reggelire, eb√©dre √©s uzsonn√°ra is. (De fogat mosni az√©rt nem felejtettek el!)", 
                storyImageText: "N√©zd, a Mikul√°s aj√°nd√©ka a v√∂dr√∂mben! üòç",
                storyImageUrl: "placeholder_day7.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "MAMA!!! A Mikul√°s tudta, hogy itt lakom, √©s mit szeretek!!! üòç Hozott gumihalat a v√∂dr√∂mbe, tele van v√≠zi kincsekkel! Ez a legjobb napom! Most gyorsan megeszem az √∂sszes csokit, miel≈ëtt Herold elveszi! Nagyon boldog vagyok! üê≥", 
                    "Neked is hozott valamit! Ezt a puha Selyem hajgumit a kis dobozban tal√°lod. üéÄ"
                ], 
                replies: [{u: "De fal√°nk vagy! üòÇ", c: "Tudod, hogy szeretem az √©deset! Szia! üê∑"}, {u: "Buck√≥ gumihalai a legnagyobb kincs?", c: "Igen! Az volt a legmen≈ëbb aj√°nd√©k! Szia! üê†"}]
            },
            // 8. HEROLD (Szeleburdi) - Az els≈ë h√≥pih√©k
            { 
                id: 8, 
                char: "herold", 
                title: "Az els≈ë h√≥pih√©k", 
                storyPage1: "D√©lut√°n valami csoda t√∂rt√©nt. Az √©gb≈ël apr√≥, feh√©r vattacukrok kezdtek hullani. ‚Äì H√ì! ‚Äì ki√°ltotta egyszerre a h√°rom bar√°t, √©s az ablakhoz tapadtak. Gyorsan fel√∂lt√∂ztek. Hanna s√°lat k√∂t√∂tt, Herold sapk√°t h√∫zott, Buck√≥ pedig kapott egy speci√°lis, v√≠z√°ll√≥ kis mell√©nyt, hogy ne f√°zzon a hasa a hidegben.", 
                storyPage2: "A kert feh√©rbe √∂lt√∂z√∂tt. Herold kiny√∫jtotta a nyelv√©t, √©s elkapott egy h√≥pih√©t. ‚Äì Milyen √≠ze van? ‚Äì k√©rdezte Hanna. ‚Äì Olyan, mint a hideg limon√°d√©, csak citrom √©s cukor n√©lk√ºl! ‚Äì v√°laszolta Herold. Buck√≥ megpr√≥b√°lt 'h√≥angyalt' csin√°lni, de mivel nincsenek karjai √©s l√°bai, ink√°bb egy nagy 'h√≥-kiflit' siker√ºlt alkotnia a h√≥ban hemperg≈ëzve.", 
                storyImageText: "N√©zd, ez lett Buck√≥ h√≥-kiflije! ü§£",
                storyImageUrl: "placeholder_day8.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama, esik a h√≥! ‚ùÑÔ∏è Nagyon vicces! Meg is k√≥stoltam, olyan mint a fagyott v√≠z, csak √≠z n√©lk√ºl. Kint vagyunk, j√°tszunk, √©s csin√°ltunk egy hatalmas h√≥-kiflit is Buck√≥val. Kicsit hideg van, de nem f√°zunk! K√©sz√ºl√ºnk a nagy h√≥csat√°ra! ü¶õ", 
                    "Hogy te se f√°zz, itt egy finom illat√∫ Test√°pol√≥. Kend be magad vele f√ºrd√©s ut√°n! ü••"
                ], 
                replies: [{u: "H√≥-kifli! üòÇ", c: "Pr√≥b√°ld ki! A b√°ln√°knak ez j√°r! Szia! üêã"}, {u: "Vigy√°zzatok, meg ne f√°zzatok!", c: "V√≠z√°ll√≥ vagyok! Kicsit sem f√°zom! Szia!"}]
            },
            // 9. BUCK√ì (Kalandor) - H√≥-b√°lna √©p√≠t√©s
            { 
                id: 9, 
                char: "bucko", 
                title: "H√≥-b√°lna √©p√≠t√©s", 
                storyPage1: "Mindenki h√≥embert √©p√≠t t√©len. De nem ≈ëk! ≈êk valami k√ºl√∂nlegeset akartak. ‚Äì √âp√≠ts√ºnk egy H√≥-b√°ln√°t! ‚Äì javasolta Hanna, √©s Buck√≥ra kacsintott. Hatalmas h√≥goly√≥kat gy√∫rtak √∂ssze, de nem egym√°s tetej√©re tett√©k ≈ëket, hanem egym√°s mell√©, hossz√∫ sorban. A H√≥-b√°lna uszonya j√©gcsapb√≥l k√©sz√ºlt, a szeme pedig k√©t nagy darab sz√©n volt, amit a f√©szerben tal√°ltak.", 
                storyPage2: "‚Äì De mi legyen az orr√°val? ‚Äì t≈±n≈ëd√∂tt Herold. V√©g√ºl egy s√°rgar√©p√°t nyomtak a feje tetej√©re. ‚Äì Ez nem az orra, te butus! Ez a l√©gz≈ëny√≠l√°sa! ‚Äì magyar√°zta b√ºszk√©n Buck√≥, √©s boldogan p√≥zolt a h√≥b√≥l k√©sz√ºlt, fagyos hasonm√°sa mellett.", 
                storyImageText: "N√©zd, √≠gy n√©z ki a H√≥-b√°lna s√°rgar√©pa l√©gz≈ëny√≠l√°sa!",
                storyImageUrl: "placeholder_day9.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama, k√©pzeld! Csin√°ltunk egy h√≥embert, ami √∫gy n√©z ki, mint √©n, egy hatalmas H√≥-b√°ln√°t! ‚òÉÔ∏è Olyan nagy lett, mint egy kis sziget! Van l√©gz≈ëny√≠l√°sa is a tetej√©n, pont mint nekem! Nagyon hideg a kezem, de meg√©rte! K√ºld√ºnk r√≥la fot√≥t (gondolatban)! üê≥", 
                    "A b√°ln√°k √©s a H√≥-b√°ln√°k is im√°dj√°k a vizet. Ezt a Hidrat√°l√≥ f√°tyolmaszkot neked k√ºld√∂m, hogy hidrat√°lt maradj! üíß"
                ], 
                replies: [{u: "Hogy n√©z ki a b√°lna?", c: "Nagyon puf√≥k! Szia! üêã"}, {u: "Mekkora lett?", c: "Hatalmas! L√°tnod kell! Szia!"}]
            },
            // 10. HEROLD (Fal√°nk) - A forr√≥ csoki hadm≈±velet
            { 
                id: 10, 
                char: "herold", 
                title: "A forr√≥ csoki hadm≈±velet", 
                storyPage1: "A nagy h√≥ban j√°t√©k ut√°n mindh√°rman vacogva mentek be a h√°zba. Az orruk piros volt, a kez√ºk j√©ghideg. ‚Äì Forr√≥ csoki id≈ë! ‚Äì jelentette be Hanna hat√°rozottan. Feltett√©k a tejet a t≈±zhelyre. Herold feladata volt a csokol√°d√© t√∂rdel√©se, de valahogy minden harmadik kocka a sz√°j√°ban k√∂t√∂tt ki a l√°bas helyett.", 
                storyPage2: "‚Äì Herold, ha √≠gy folytatod, csak forr√≥ tej√ºnk lesz csoki n√©lk√ºl! ‚Äì nevetett Hanna. V√©g√ºl elk√©sz√ºlt a g≈ëz√∂lg≈ë ital. Tettek bele tejsz√≠nhabot, √©s annyi pillecukrot, hogy azok kis szigetekk√©nt √∫szk√°ltak a tetej√©n. Buck√≥ b√∂gr√©je akkora volt, mint egy v√°za, de egy hajt√°sra kiitta az eg√©szet.", 
                storyImageText: "N√©zd a mi pillecukor sziget√ºnket a csokiban! ‚òï",
                storyImageUrl: "placeholder_day10.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama! F≈ëzt√ºnk forr√≥ csokit! ‚òï Kicsit sok lett a pillecukor, mert v√©letlen√ºl beleborult az eg√©sz zacsk√≥, de √≠gy legal√°bb nagyon √©des! √ân is sokat ittam, rem√©lem, nem fog f√°jni a pocim, de nagyon finom volt! Most √©ppen Buck√≥val n√©zz√ºk a pillecukor szigeteket a b√∂gr√©nkben. Meleg√≠t t√©ged is! ü¶õ", 
                    "Neked k√ºld√ºnk egy kis extra melegs√©get: egy Meleg√≠t≈ë szemmaszkot. Pihenj le vele 10 percre! ‚òï"
                ], 
                replies: [{u: "Finom volt? üòã", c: "Mennyei! Buck√≥ az eg√©szet megitta! Szia! ü•∞"}, {u: "Herold, csak a csoki... üòÖ", c: "Bocs√°nat! De meg√©rdemlem! Szia! üòâ"}]
            },
            // 11. HANNA (Gondoskod√≥) - Lev√©l a t√°volba
            { 
                id: 11, 
                char: "hanna", 
                title: "Lev√©l a t√°volba", 
                storyPage1: "M√°r nagyon hi√°nyoztak a sz√ºl≈ëk. Est√©nk√©nt sokat besz√©lgettek r√≥luk. ‚Äì √çrjunk nekik levelet! ‚Äì javasolta Herold. El≈ëvettek egy nagy √≠v pap√≠rt √©s a sz√≠nes ceruz√°kat. Herold lerajzolta a H√≥-b√°ln√°t (b√°r ink√°bb hasonl√≠tott egy nagy feh√©r krumplira, aminek kalapja van). Hanna gy√∂ngybet≈±kkel r√°√≠rta: 'Nagyon j√≥l vagyunk, de a palacsinta a plafonra ragadt (m√°r leszedt√ºk!).'", 
                storyPage2: "Buck√≥ is akart √≠rni. ‚Äì √ân b√°lnanyelven √ºzenek! ‚Äì mondta. Bem√°rtotta az uszony√°t a k√©k fest√©kbe, √©s egy nagy pac√°t nyomott a pap√≠r k√∂zep√©re. ‚Äì Ez azt jelenti: Szeretlek titeket! ‚Äì ford√≠totta le b√ºszk√©n a t√∂bbieknek.", 
                storyImageText: "N√©zd, ez Buck√≥ √ºzenete b√°lnanyelven! üê≥",
                storyImageUrl: "placeholder_day11.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama, √≠rtunk neked egy hossz√∫ levelet! üìù Herold egy nagyon sz√©p rajzot is k√©sz√≠tett, √©s Buck√≥ is k√ºld√∂tt egy k√ºl√∂nleges b√°lnanyelvi √ºzenetet egy k√©k pac√°ban. Nagyon j√≥ gyerekek vagyunk, minden rendben, de m√°r hi√°nyzol! Rem√©lj√ºk, hamar megkapod az √ºzenet√ºnket! üéÄ", 
                    "A sok k√∂rm√∂l√©sben elf√°radt a mancsunk. Neked k√ºld√ºnk egy Hidrat√°l√≥ k√©zmaszkot, hogy pihe-puha legyen a kezed! üß§"
                ], 
                replies: [{u: "L√°ttam a k√©k pac√°t! ü•π", c: "A legszebb √ºzenet! Szia! üêã"}, {u: "Mi a H√≥-b√°lna a rajzon?", c: "Herold szerint krumpli, de √©n azt mondom, m≈±v√©szet! Szia!"}]
            },
            // 12. BUCK√ì (Kalandor) - A viharos √©jszaka
            { 
                id: 12, 
                char: "bucko", 
                title: "A viharos √©jszaka", 
                storyPage1: "√âjszaka hatalmas sz√©l t√°madt. Az ablakok z√∂r√∂gtek, az √°gak kopogtattak az √ºvegen, mintha be akarn√°nak j√∂nni. Hirtelen: CSATT! Egy hatalmas d√∂rg√©s r√°zta meg a h√°zat. Buck√≥, aki √°ltal√°ban b√°tor, most ijedt√©ben be akart b√∫jni az √°gy al√°. De sajnos az ut√≥bbi napokban t√∫l sok m√©zeskal√°csot evett, √≠gy a pocakja beszorult.", 
                storyPage2: "‚Äì Seg√≠ts√©g! A pocakom csapd√°ba esett! ‚Äì kiab√°lta k√©ts√©gbeesetten. Herold √©s Hanna azonnal ugrottak. Egyik√ºk h√∫zta a fark√°t, m√°sikuk tolta az orr√°t. ‚Äì H√∫zd be a leveg≈ët, Buck√≥! ‚Äì vez√©nyelt Hanna. V√©g√ºl egy nagy 'PLOPP' hanggal kiszabadult. Aznap √©jjel mindh√°rman egy nagy kupacban, egym√°st √∂lelve aludtak el a nappali sz≈ënyeg√©n, biztons√°gban.", 
                storyImageText: "N√©zd, ez a ment≈ëakci√≥! (K√©p a beszorult Buck√≥r√≥l!)",
                storyImageUrl: "placeholder_day12.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Kicsit f√©ltem az √©gzeng√©st≈ël, de m√°r b√°tor vagyok! üå©Ô∏è K√©pzeld, majdnem beszorultam az √°gy al√°, de Herold√©k igazi h≈ës√∂k voltak √©s kiszabad√≠tottak! Nagyon √∂r√ºl√∂k, hogy vigy√°znak r√°m! Most m√°r minden csendes, √©s biztons√°gban vagyunk. üê≥", 
                    "Ha te is f√°zn√°l, h√∫zd fel ezt a Puha vastag zoknit, √©s b√∫jj be az √°gyba! üß¶"
                ], 
                replies: [{u: "J√≥l vagytok? üò±", c: "Igen! Buck√≥ is! Szia! üí™"}, {u: "Mi√©rt b√∫jt Buck√≥ az √°gy al√°?", c: "F√©lt a d√∂rg√©st≈ël, de most m√°r b√°tor! Szia! üòâ"}]
            },
            // 13. HANNA (Rendteremt≈ë) - Gubancok √©s g√∂mb√∂k
            { 
                id: 13, 
                char: "hanna", 
                title: "Gubancok √©s g√∂mb√∂k", 
                storyPage1: "El√©rkezett az id≈ë a d√≠szek ellen≈ërz√©s√©re. Hanna lehozta a padl√°sr√≥l a dobozokat. ‚Äì Jaj ne! ‚Äì ki√°ltott fel, amint kinyitotta az els≈ët. A kar√°csonyi izz√≥sor egyetlen hatalmas, rem√©nytelen gomb√≥cc√° gabalyodott √∂ssze, mintha egy vil√°g√≠t√≥ spagetti lenne.", 
                storyPage2: "‚Äì √ân megoldom! ‚Äì aj√°nlkozott Herold, √©s b√°tran belevetette mag√°t a k√°belrengetegbe. T√≠z perc m√∫lva m√°r ≈ë is bele volt tekeredve, mint egy kar√°csonyi herny√≥. Csak a szeme l√°tszott ki. V√©g√ºl Hanna szabad√≠totta ki ≈ët is √©s az √©g≈ësort is. K√∂zben Buck√≥ a g√∂mb√∂ket v√°logatta sz√≠nek szerint: a k√©kek voltak a kedvencei, mert a tengerre eml√©keztett√©k.", 
                storyImageText: "N√©zd, ez volt Herold a gubancban! ü§£",
                storyImageUrl: "placeholder_day13.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Jaj Mama, k√©pzeld, az √©g≈ësor megt√°madta Heroldot! üéÑ √ögy n√©zett ki, mint egy vil√°g√≠t√≥ m√∫mia a padl√≥n, teljesen belegabalyodott! Szerencs√©re kiszabad√≠tottam, de a haja el√©gg√© gubancos lett a nagy ment≈ëakci√≥ban. Ne agg√≥dj, az √©g≈ësort m√°r majdnem kibogoztam, √©s nemsok√°ra d√≠sz√≠t√ºnk! üéÄ", 
                    "Hogy a te hajad ne legyen gubancos, k√ºld√ºnk egy szuper Hajpakol√°st. Csillogni fogsz! üíá‚Äç‚ôÄÔ∏è"
                ], 
                replies: [{u: "Jaj, az a gubanc... ü§¶‚Äç‚ôÄÔ∏è", c: "T√∫l√©lte! Mint √©n! Szia! üí™"}, {u: "Herold j√≥l van?", c: "Igen, m√°r nassol valahol! Szia! üòâ"}]
            },
            // 14. HEROLD (Szeleburdi) - A s√≥s s√ºtem√©ny rejt√©lye
            { 
                id: 14, 
                char: "herold", 
                title: "A s√≥s s√ºtem√©ny rejt√©lye", 
                storyPage1: "√öjra s√ºt√©sre adt√°k a fej√ºket. Most m√©zeskal√°csot k√©sz√≠tettek, mert annak olyan j√≥ illata van. Hanna nagyon figyelt a receptre. ‚Äì Liszt, toj√°s, m√©z... √©s cukor! ‚Äì sorolta, √©s bele√∂nt√∂tt egy nagy b√∂gre feh√©r port a t√©szt√°ba. Amikor kis√ºltek a form√°k, Herold azonnal bekapott egyet, m√©g forr√≥n.", 
                storyPage2: "De a mosolya hirtelen lefagyott az arc√°r√≥l. ‚Äì Pf√∫j! Ez borzalmas! ‚Äì k√∂pte ki a falatot. Hanna megk√≥stolta. ‚Äì Jaj, ez nem cukor volt, hanem s√≥! Kider√ºlt, hogy Hanna √∂sszekeverte a dobozokat! Az eg√©sz adag a kuk√°ban v√©gezte, de legal√°bb j√≥t nevettek a 's√≥s-kal√°cson'. ‚Äì A s√≥s vizet szeretem, de a s√≥s m√©zeskal√°csot m√©g √©n sem! ‚Äì √°llap√≠totta meg Buck√≥.", 
                storyImageText: "N√©zd, ezt kaptuk s√≥ helyett! ü§¢ (K√©p a s√≥s m√©zeskal√°csr√≥l)",
                storyImageUrl: "placeholder_day14.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Soha ne egy√©l Hanna mai s√ºtij√©b≈ël! ü§¢ S√ìS volt! Azt hittem, menten el√°julok, akkora csal√≥d√°s volt! Most gyorsan kell szereznem valami √©deset, hogy elm√∫ljon a s√≥s ut√≥√≠z! Tal√°ltunk egy kis csokit, de az elt≈±nt cukrot is megtal√°ltuk! K√°r, hogy a s√ºti kuk√°ba ker√ºlt! ü¶õ", 
                    "Megtal√°ltuk a cukrot, ami a s√ºtib≈ël kimaradt! Bocs√°natk√©ppen itt egy Cukros testrad√≠r. Ezzel √©desebb lesz a napod! üç¨"
                ], 
                replies: [{u: "√ì, a s√≥... üôà", c: "T√∫l sok volt a tenger √≠z! Szia! üòú"}, {u: "M√©g mindig √©hes Herold?", c: "Most m√°r igen! Szaladok s√ºtit keresni! Szia!"}]
            },
            // 15. HANNA (Kreat√≠v) - A t√∂k√©letes figur√°k
            { 
                id: 15, 
                char: "hanna", 
                title: "A t√∂k√©letes figur√°k", 
                storyPage1: "A s√≥s katasztr√≥fa ut√°n √∫jra nekil√°ttak. Most Herold h√°romszor is megk√≥stolta a feh√©r port: Cukor! Mehet bele! Nagyon kreat√≠vak voltak a form√°z√°sn√°l. Hanna csin√°lt egy Mama-figur√°t √©s egy Papa-figur√°t, cukorm√°z-mosollyal √©s kis cukorgy√∂ngy szemekkel.", 
                storyPage2: "Herold egy puf√≥k vizilovat form√°zott (saj√°t mag√°r√≥l), aminek mazsola volt a k√∂ld√∂ke. Buck√≥ pedig egy b√°ln√°t gy√∫rt, de mivel a t√©szta s√ºt√©s k√∂zben megn≈ëtt, a b√°lna akkora lett, mint egy kisebb keny√©r. ‚Äì Ezt el kell tenn√ºnk nekik! ‚Äì mondt√°k, √©s a legszebbeket egy f√©mdobozba z√°rt√°k, hogy frissek maradjanak a sz√ºl≈ëk √©rkez√©s√©ig.", 
                storyImageText: "N√©zd, a te form√°d t√∂k√©letes lett! ü•∞ (K√©p a Mama-kekszedr≈ël)",
                storyImageUrl: "placeholder_day15.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama, a m√°sodik adag s√ºt√©s m√°r t√∂k√©letesen siker√ºlt, siker√ºlt a s√≥s-cukor katasztr√≥f√°t elker√ºlni! üç™ Csin√°ltunk egy r√≥lad form√°zott kekszet is, ami nagyon hasonl√≠t r√°d, √©s persze egy m√°sikat Heroldr√≥l mazsolak√∂ld√∂kkel. Elz√°rtuk a legszebbeket egy dobozba, hogy Kar√°csonykor frissek legyenek! üéÄ", 
                    "Mi a t√©szt√°t gy√∫rtuk form√°ra, te pedig k√©nyeztesd az arcodat ezzel a Gua Sha k≈ëvel. Sim√≠tsd ki vele a r√°ncokat! üóø"
                ], 
                replies: [{u: "J√≥l siker√ºlt a vizil√≥? ü•∞", c: "A legszebb a mazsolak√∂ld√∂kkel! Szia! üòâ"}, {u: "Megtetted, hogy elz√°rtad a s√ºtiket?", c: "Igen! Biztons√°gban vannak! Szia!"}]
            },
            // 16. BUCK√ì (Kalandor) - Mozi a nappaliban
            { 
                id: 16, 
                char: "bucko", 
                title: "Mozi a nappaliban", 
                storyPage1: "Kint s√∂t√©t volt √©s hideg, de bent igazi mozi-hangulat uralkodott. √âp√≠tettek egy hatalmas er≈ëd√∂t p√°rn√°kb√≥l √©s takar√≥kb√≥l a TV el≈ëtt. Ez volt a VIP p√°holy. Kukoric√°t pattogtattak, ami nagyon vicces volt, mert Herold elfelejtette r√°tenni a fed≈ët a l√°basra. A pattogatott kukorica szanasz√©t rep√ºlt a konyh√°ban, mint egy √°gy√∫b√≥l l≈ëtt√©k volna! Buck√≥ a leveg≈ëben kapdosta el a szemeket.", 
                storyPage2: "Betett√©k a 'Reszkessetek, bet√∂r≈ëket!'-et. Herold a has√°t fogta a nevet√©st≈ël, amikor a bet√∂r≈ëk elestek. Buck√≥ viszont a meghat√≥ r√©szekn√©l s√≠rva fakadt. ‚Äì Olyan sz√©p, amikor a v√©g√©n mindenki tal√°lkozik! ‚Äì szipogta, √©s egy pap√≠rzsebkend≈ëvel t√∂r√∂lgette a f√∫j√≥ny√≠l√°s√°t.", 
                storyImageText: "N√©zd, √©p√≠tett√ºnk egy VIP p√°rnaer≈ëd√∂t! üé¨",
                storyImageUrl: "placeholder_day16.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama, megn√©zt√ºk a Reszkessetek, bet√∂r≈ëket a p√°rnaer≈ëdben! üé¨ Hatalmas volt a m√≥ka, m√©g a pattogatott kukorica is sz√©trep√ºlt a konyh√°ban, mint egy √°gy√∫! Kicsit s√≠rtam a v√©g√©n, mert nagyon meghat√≥ volt! Szerintem neked is meg kell n√©zned a kedvenc filmedet, de el≈ëtte pihenj egy kicsit! üê≥", 
                    "Ind√≠tsd el te is a kedvenc filmedet! Pont addig tart, am√≠g ez a L√°bmaszk pihenteti a l√°badat. J√≥ moziz√°st! ü¶∂"
                ], 
                replies: [{u: "A kukorica a plafonon is van? üòÖ", c: "Picit! De mindent megesz√ºnk! Szia! üòú"}, {u: "Melyik filmet n√©zt√©tek?", c: "A Reszkessetek, bet√∂r≈ëket! Kir√°ly! Szia!"}]
            },
            // 17. HEROLD (Szeleburdi) - A ferde feny≈ëfa
            { 
                id: 17, 
                char: "herold", 
                title: "A ferde feny≈ëfa", 
                storyPage1: "Reggel csengettek. Meg√©rkezett a feny≈ëfa! ‚Äì H≈±, de magas! ‚Äì √°mult el Hanna, alig l√°tta a tetej√©t. Nagy nehezen bevonszolt√°k a nappaliba. Herold tartotta a t√∂rzset, Hanna csavarta a talpat. ‚Äì M√©g egy kicsit balra... most jobbra... most d≈ël! VIGY√ÅZZ!", 
                storyPage2: "A fa elindult, √©s puff! Egyenesen a fotelre d≈ëlt, maga al√° temetve egy d√≠szp√°rn√°t. Fel√°ll√≠tott√°k √∫jra. Kicsit ferde volt, kicsit kopasz volt az egyik oldala, √©s kicsit gyant√°s lett t≈ële a sz≈ënyeg. ‚Äì Szerintem t√∂k√©letes ‚Äì mondta Buck√≥, √©s szeretettel n√©zett a f√°ra. ‚Äì Olyan, mint mi. Kicsit szeleburdi, de a mienk!", 
                storyImageText: "N√©zd, ez a mi ferde, de gy√∂ny√∂r≈± f√°nk! üå≤",
                storyImageUrl: "placeholder_day17.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama, megj√∂tt a fa! üå≤ K√©pzeld, kicsit d√ºl√∂ng√©lt, mint √©n korcsoly√°z√°s k√∂zben, √©s r√° is borult a fotelre, de most m√°r stabil! Buck√≥ szerint t√∂k√©letes! Egy kicsit gyant√°s lett a sz≈ënyeg, de nem baj, majd Buck√≥ letakar√≠tja a sz√°j√°val! Rem√©lem, neked is illatos a napod! ü¶õ", 
                    "A f√°nk z√∂ld √©s illatos, ez a Z√∂ld agyagos maszkis pont ilyen! Kend fel, √©s t√∂lt≈ëdj fel! üåø"
                ], 
                replies: [{u: "Ferde fa, sz√©p fa! üòÖ", c: "Pontosan! A mienk! Szia! üíô"}, {u: "Buck√≥, mi√©rt mondtad, hogy t√∂k√©letes?", c: "Mert az a legfontosabb, hogy a mienk! Szia!"}]
            },
            // 18. HANNA (Gondoskod√≥) - Csillagsz√≥r√≥ √©s girland
            { 
                id: 18, 
                char: "hanna", 
                title: "Csillagsz√≥r√≥ √©s girland", 
                storyPage1: "A mai nap a fa d√≠sz√≠t√©s√©r≈ël sz√≥lt. Felker√ºltek a tegnap megmentett g√∂mb√∂k. Hanna gy√∂ny√∂r≈± masnikat k√∂t√∂tt az √°gakra. Herold a szaloncukrokat aggatta fel, de valami rejt√©lyes okn√°l fogva a szaloncukrok fele √ºres volt, mire a f√°ra ker√ºlt. Csak az √ºres, csillog√≥ pap√≠rok l√≥gtak.", 
                storyPage2: "‚Äì Herold, mi√©rt van csoki a sz√°dban? ‚Äì k√©rdezte gyanakv√≥an Hanna. ‚Äì Csak ellen≈ëriztem a min≈ës√©get! Nem tehet√ºnk fel romlott csokit! ‚Äì v√©dekezett teli sz√°jjal Herold. A cs√∫csd√≠sz felrak√°sa volt a legnehezebb. Herold felm√°szott egy sz√©kre, Buck√≥ megtolta az orr√°val a fenek√©t, Hanna pedig navig√°lt. Siker√ºlt! A csillag ferd√©n, de b√ºszk√©n ragyogott a fa tetej√©n.", 
                storyImageText: "N√©zd, a cs√∫csd√≠sz a hely√©n! ‚ú®",
                storyImageUrl: "placeholder_day18.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama, elk√©sz√ºlt a kar√°csonyfa! üéÄ Herold szerint a szaloncukrok fele 'romlott' volt, de √©n tudom, hogy csak megegyte! üòÇ Ne agg√≥dj, a cs√∫csd√≠sz felker√ºlt, csapatmunk√°val, √©s gy√∂ny√∂r≈±en csillog! Rem√©lem, a tied is csillog m√°r, √©s lassan √°tengeded magad az √ºnnepi hangulatnak! üéÄ", 
                    "A kar√°csonyfa m√°r csillog-villog, most a mosolyodon a sor! Ez az Ajakolaj √∫gy ragyog majd a sz√°don, mint a legszebb d√≠sz. üíÑ"
                ], 
                replies: [{u: "Herold, a 'min≈ës√©gellen≈ër'! üòÖ", c: "Tudod, a biztons√°g a legfontosabb! Szia! üòâ"}, {u: "√úgyesek voltatok a cs√∫csd√≠sszel!", c: "Buck√≥ n√©lk√ºl nem ment volna! Szia!"}]
            },
            // 19. HEROLD (Szeleburdi) - A v√°ratlan vend√©g
            { 
                id: 19, 
                char: "herold", 
                title: "A v√°ratlan vend√©g", 
                storyPage1: "Mik√∂zben te√°ztak, furcsa kapar√°sz√°st hallottak a k√©m√©ny fel≈ël. ‚Äì J√∂n a J√©zuska? ‚Äì suttogta Herold t√°gra ny√≠lt szemekkel. De nem a J√©zuska volt, hanem egy kormos, kicsi ver√©b, aki v√©letlen√ºl beesett a kandall√≥ba!", 
                storyPage2: "Szeg√©ny mad√°rka ijedten repkedett k√∂rbe-k√∂rbe, kormot sz√≥rva a frissen felmosott padl√≥ra √©s a feh√©r f√ºgg√∂nyre. Hanna gyorsan kinyitotta az ablakot. Buck√≥ kedvesen, halkan csipogott neki (b√°lnanyelven), hogy megnyugtassa. V√©g√ºl a kismad√°r kital√°lt a szabadba. ‚Äì Nevezz√ºk el Kormosnak! ‚Äì mondta Herold. ‚Äì Rem√©lem, visszaj√∂n kar√°csonyra, de legk√∂zelebb ink√°bb az ajt√≥n kereszt√ºl.", 
                storyImageText: "N√©zd, Kormos m√°r elrep√ºlt! üê¶ (K√©p a kormos k√©m√©nyr≈ël)",
                storyImageUrl: "placeholder_day19.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama! Volt egy v√°ratlan vend√©g√ºnk, egy kormos ver√©b leesett a k√©m√©nyen! üê¶ Kicsit kormos lett a sz≈ënyeg meg a f√ºgg√∂ny is, de Hanna kiengedte, √©s m√°r j√≥l van! Szerencs√©re Buck√≥ nem ijedt meg t≈ële! Mi most Hanna ut√°n takar√≠tunk egy kicsit. Hi√°nyzol! ü¶õ", 
                    "A mad√°rk√°r√≥l jutott esz√ºnkbe ez a Fekete maszk. Ne ijedj meg a sz√≠n√©t≈ël, te szebb leszel t≈ële! üñ§"
                ], 
                replies: [{u: "Szeg√©ny ver√©b! üò•", c: "De m√°r szabad! Szia! üòú"}, {u: "Kimosod a f√ºgg√∂nyt?", c: "Hanna csin√°lja! √ân csak n√©zem! Szia!"}]
            },
            // 20. HANNA (Rendteremt≈ë) - Titkos m≈±hely
            { 
                id: 20, 
                char: "hanna", 
                title: "Titkos m≈±hely", 
                storyPage1: "A sz√ºl≈ëknek is kell aj√°nd√©k! De mib≈ël? Zsebp√©nz√ºk m√°r nem maradt, √≠gy a saj√°t tehets√©g√ºket haszn√°lt√°k. Herold, aki im√°dott festeni, k√©sz√≠tett egy portr√©t a csal√°dr√≥l. Igaz, Pap√°nak z√∂ld lett a feje, mert elfogyott a b≈ërsz√≠n≈± fest√©k, de a szeretet volt a l√©nyeg.", 
                storyPage2: "Hanna egy gy√∂ny√∂r≈± nyakl√°ncot f≈±z√∂tt Mam√°nak sz√°razt√©szt√°b√≥l, amit aranyra festett csill√°mporral. Buck√≥ pedig √≠rt egy dalt. ‚Äì Ezt majd el√©neklem nekik, amikor bel√©pnek! ‚Äì mondta. A dal c√≠me ez volt: 'A legszebb √≥ce√°n a csal√°dom szeretete'. Herold kicsit megk√∂nnyezte a pr√≥b√°t.", 
                storyImageText: "N√©zd, egy kis k√©p a titkos m≈±helyb≈ël! ü§´",
                storyImageUrl: "placeholder_day20.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Titkos projektben vagyunk, Mama! ü§´ Nem mondhatjuk el pontosan, mit csin√°lunk, de k√©sz√ºlnek a legszebb aj√°nd√©kok Papa meg a te sz√°modra! Herold egy kicsit elszaladt a fest√©kkel, de a sz√≠v√ºnk benne van! K√©rlek, ne is k√©rdezz semmit, Kar√°csonykor megl√°tod! Nagyon izgatott vagyok! üéÄ", 
                    "Mi festett√ºnk, de Apa seg√≠tett kinyomtatni a legszebb eml√©ket: egy K√∂z√∂s fot√≥t r√≥lunk! Tedd ki az asztalra! ‚ù§Ô∏è"
                ], 
                replies: [{u: "Z√∂ld fej≈± Papa! ü§£", c: "Ne nevess! M≈±v√©szi szabads√°g! Szia! üòú"}, {u: "√ânekelj nekem is egy keveset!", c: "Majd kar√°csonykor! Tartsuk a meglepet√©st! Szia!"}]
            },
            // 21. HEROLD (Szeleburdi) - A nagy sz√°nk√≥-futam
            { 
                id: 21, 
                char: "herold", 
                title: "A nagy sz√°nk√≥-futam", 
                storyPage1: "A domboldalon vastag h√≥ √°llt, a nap h√©t √°gra s√ºt√∂tt. ‚Äì Versenyezz√ºnk! ‚Äì ki√°ltotta Herold. De csak egy nagy sz√°nk√≥juk volt. √çgy h√°t fel√ºltek r√° mindh√°rman: el√∂l a kis b√°lna (≈ë volt az √°ramvonalas orr), k√∂z√©pen Hanna, h√°tul Herold, a s√∫ly. ‚Äì 3, 2, 1, RAJT!", 
                storyPage2: "A sz√°nk√≥ sz√°guldott lefel√©, gyorsabban, mint egy rak√©ta. ‚Äì F√âKEZZ! F√âKEZZ! ‚Äì vis√≠totta Hanna. ‚Äì NEM TUDOK! ‚Äì ord√≠totta Herold. Belecsap√≥dtak egy hatalmas h√≥buck√°ba a domb alj√°n. H√≥ bor√≠totta be ≈ëket tet≈ët≈ël talpig. Amikor ki√°st√°k magukat, √∫gy n√©ztek ki, mint h√°rom dundi h√≥ember. Soha ilyen j√≥t nem nevettek m√©g!", 
                storyImageText: "N√©zd, √≠gy lett bel≈ëlem h√≥ember! ü§£",
                storyImageUrl: "placeholder_day21.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama, SZ√ÅNK√ìZTUNK!!! üõ∑ Akkor√°t est√ºnk a domb alj√°n, hogy h√≥ember lett bel≈ël√ºnk! De nagyon vicces volt! Hanna persze sik√≠tott, de Buck√≥ is nevetett! Olyan boldog vagyok, hogy m√°r alig v√°rom, hogy haza√©rjetek! ü¶õ", 
                    "H√∫, de s√ºv√≠t a sz√©l kint! Itt egy Ajak√°pol√≥, kend be a sz√°d, nehogy kicserepesedjen a nagy nevet√©sben! üíã"
                ], 
                replies: [{u: "Nagyon vigy√°zzatok magatokra! üò±", c: "M√°r bent vagyunk! √âs nevet√ºnk! Szia! üòú"}, {u: "H√≥ember! T√©nyleg!", c: "√ân voltam a legdundibb! Szia!"}]
            },
            // 22. HANNA (Gondoskod√≥) - Az utols√≥ sim√≠t√°sok
            { 
                id: 22, 
                char: "hanna", 
                title: "Az utols√≥ sim√≠t√°sok", 
                storyPage1: "M√°r csak kett≈ët kell aludni! A fesz√ºlts√©g szinte tapinthat√≥ volt a h√°zban. Ma mindent √∫jra ellen≈ëriztek, mintha egy fontos vizsg√°ra k√©sz√ºln√©nek. Tiszta a lak√°s? Igen (a kormos foltokat elt√ºntett√©k). Megvannak a s√ºtik? Igen (a doboz biztons√°gban a polc tetej√©n, ahol Herold nem √©ri el). Megvannak az aj√°nd√©kok? Igen, sz√©pen becsomagolva a fa alatt.", 
                storyPage2: "Herold m√©g a fog√°t is h√°romszor mosta meg este, √©s a legszebb, cs√≠kos pizsam√°j√°t k√©sz√≠tette ki. ‚Äì √ögy izgulok, hogy remeg a pocakom! ‚Äì mondta az √°gyban. ‚Äì Az eny√©m is! ‚Äì tette hozz√° Buck√≥. ‚Äì Pedig nekem vastag zs√≠rr√©tegem van! N√©zt√©k a villog√≥ f√©nyeket, √©s lassan, nagyon lassan elnyomta ≈ëket az √°lom.", 
                storyImageText: "N√©zd, m√°r mindent leellen≈ëriztem! üëå",
                storyImageUrl: "placeholder_day22.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama, m√°r csak kett≈ët kell aludni, elk√©peszt≈ë! üò± Minden k√©szen √°ll, a lak√°s tiszta, a fa gy√∂ny√∂r≈±, √©s Herold is a legszebb pizsam√°j√°ban v√°rja a reggelt. √ân is nagyon izgulok, de a gondolat, hogy holnap itt lesztek, mindent fel√ºl√≠r! Te is pihenj r√° a holnapra, hogy a legszebb lehess! üéÄ", 
                    "Herold fogat mosott, mi takar√≠tottunk. Itt egy Sz√©p√≠t≈ë ampulla, hogy holnap te legy√©l a legszebb az √ºnnepen! ‚ú®"
                ], 
                replies: [{u: "Ti vagytok a leg√ºgyesebbek! ü•∞", c: "Tudom! De csak √©rted! Szia! üòä"}, {u: "Megvan a s√ºti?", c: "Igen! Herold nem √©rte el! Szia!"}]
            },
            // 23. BUCK√ì (Kalandor) - Szenteste el≈ëtti √©jjel
            { 
                id: 23, 
                char: "bucko", 
                title: "Szenteste el≈ëtti √©jjel", 
                storyPage1: "Minden k√©sz volt. A fa f√©nyei √©gtek, a h√°zban fah√©j, feny≈ë √©s szeretet illata terjengett. Nem tudtak elaludni a h√°l√≥szob√°ban. T√∫l nagy volt a csend. ‚Äì Menj√ºnk le! ‚Äì javasolta Hanna. Levitt√©k a h√°l√≥zs√°kokat a nappaliba, √©s mindh√°rman a kar√°csonyfa al√° fek√ºdtek.", 
                storyPage2: "‚Äì Szerintetek sokat n≈ëttek a sz√ºl≈ëk, am√≠g nem l√°ttuk ≈ëket? ‚Äì k√©rdezte Herold √°lmosan. ‚Äì A feln≈ëttek m√°r nem n≈ënek ‚Äì suttogta Hanna, √©s megsimogatta a fej√©t. ‚Äì De a szeretet√ºk biztosan n≈ëtt, mert annyira hi√°nyzunk nekik. ‚Äì Holnap ilyenkor m√°r itt lesznek... ‚Äì s√≥hajtott boldogan Buck√≥. N√©zt√©k a villog√≥ f√©nyeket, √©s lassan, nagyon lassan elnyomta ≈ëket az √°lom.", 
                storyImageText: "N√©zd, a fa alatt alszunk! ‚õ∫Ô∏è",
                storyImageUrl: "placeholder_day23.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "Mama, ma a fa alatt alszunk! ‚õ∫Ô∏è √çgy biztosan nem maradjunk le a pillanatr√≥l, amikor meg√©rkeztek! Minden nagyon sz√©p √©s illatos! Hanna szerint a szeretetetek n≈ëtt, √©s √©n ezzel teljesen egyet√©rtek! M√°r alig v√°rjuk, hogy holnap √∂lelhess√ºnk! üò≠üê≥", 
                    "Ma este gy√∫jtsd meg ezt a Csillagsz√≥r√≥t, √©s gondolj r√°nk! M√°r alig v√°rjuk a holnapot... ‚≠ê"
                ], 
                replies: [{u: "Nagyon szeretlek titeket! üíñ", c: "Mi is t√©ged, Mama! Szia! üò≠"}, {u: "N√©zz√©tek a f√©nyeimet!", c: "N√©zz√ºk! Gy√∂ny√∂r≈±! Szia!"}]
            },
            // 24. HEROLD (Szeleburdi) - A CSODA
            { 
                id: 24, 
                char: "herold", 
                title: "A CSODA", 
                storyPage1: "Reggel cs√∂rg√∂tt a kulcs a z√°rban. A h√°rom j√≥bar√°t egyszerre pattant fel, mintha rug√≥ lett volna alattuk. Az ajt√≥ kiny√≠lt, √©s ott √°lltak! Papa √©s Mama, kipirulva a hidegt≈ël, teli karral csomagokkal. ‚Äì MEGJ√ñTTEK! ‚Äì ord√≠totta Herold, √©s akkor√°t ugrott √∂r√∂m√©ben, hogy majdnem fell√∂kte a fogast.", 
                storyPage2: "A sz√ºl≈ëk ledobt√°k a t√°sk√°kat, √©s a f√∂ldre t√©rdeltek. Herold, Hanna √©s Buck√≥ egyszerre vetett√©k magukat a nyakukba. Volt ott s√≠r√°s, nevet√©s, √∂lel√©s √©s puszihegyek. ‚Äì Ti voltatok a leg√ºgyesebb h√°z≈ërz≈ëk a vil√°gon! ‚Äì mondta Mama, √©s megpuszilta Buck√≥ orr√°t. Ez volt a legszebb kar√°csony, mert a legnagyobb aj√°nd√©k nem a fa alatt volt, hanem az √∂lel√©s√ºkben: a csal√°d √∫jra egy√ºtt volt.", 
                storyImageText: "N√©zd, mekkor√°t ugrunk √∂r√∂m√ºnkben! ü§£",
                storyImageUrl: "placeholder_day24.jpg", // PL√âSZH√ìLDER: Cser√©ld le a t√©nyleges URL-re!
                msgs: [
                    "MAMA, PAPA! ITTHON VAGYTOK!!! Ez a legjobb kar√°csony a vil√°gon! üéÑ Akkor√°t ugrottam √∂r√∂m√∂mben, hogy a fogas is majdnem eld≈ëlt! Gyere gyorsan, √∂lelj√ºk meg egym√°st, hi√°nyozt√°l a legjobban! Gyertek gyorsan a fa al√°, minden k√©szen √°ll! ‚ù§Ô∏èü¶õ", 
                    "√âs most... nyisd ki a F≈ë Aj√°nd√©kot! Ezt neked ≈ërizt√ºk! Boldog Kar√°csonyt! üéÅ"
                ], 
                replies: [{u: "BOLDOG KAR√ÅCSONYT! üéÅ", c: "‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è"}, {u: "Megvan a s√ºti?", c: "Most m√°r szabad! Gyere gyorsan! üç™"}]
            },
        ];

        // --- √ÅLLAPOTOK (GLOBALS) ---
        let state = {
            apiKey: localStorage.getItem('geminiKey') || "",
            unlockedDays: JSON.parse(localStorage.getItem('openedDays') || '[]'),
            chatHistory: JSON.parse(localStorage.getItem('chatHistory3') || '{}'),
            currentDayId: null, // Az utolj√°ra megnyitott nap ID-je (seg√≠t a karakter azonos√≠t√°s√°ban)
            view: 'grid', // 'grid', 'story', 'chatList', 'chatDetail'
            typing: false,
            testMode: false,
            notifAfterCloseDayId: null, 
            storyPage: 1, // √öJ: A t√∂rt√©net modal aktu√°lis oldala (1 vagy 2)
        };

        // --- SEG√âDF√úGGV√âNYEK ---

        function saveState(key, value) {
            if (key === 'unlockedDays') {
                localStorage.setItem('openedDays', JSON.stringify(value));
                state.unlockedDays = value;
            } else if (key === 'chatHistory') {
                localStorage.setItem('chatHistory3', JSON.stringify(value));
                state.chatHistory = value;
            } else if (key === 'apiKey') {
                localStorage.setItem('geminiKey', value);
                state.apiKey = value;
            }
            renderApp(); 
        }

        function addNotification(name, msg, icon) {
            const notifEl = document.createElement('div');
            notifEl.className = 'ios-notification';
            notifEl.innerHTML = `
                <div class="notif-icon">${icon}</div>
                <div class="notif-content">
                    <div class="notif-header"><span class="notif-title">${name}</span><span class="notif-time">Most</span></div>
                    <div class="notif-msg">${msg}</div>
                </div>
            `;
            
            notifEl.onclick = () => {
                setView('chatList');
                notifEl.remove();
            };

            ELEMENTS.notificationContainer.appendChild(notifEl);

            setTimeout(() => {
                notifEl.remove();
            }, 5000);
        }

        function setView(newView, dayId = null) {
            // √ârtes√≠t√©s k√ºld√©se a story modal bez√°r√°sa ut√°n
            if (state.view === 'story' && newView === 'grid' && state.notifAfterCloseDayId !== null) {
                const day = STORY_DATA.find(d => d.id === state.notifAfterCloseDayId);
                if (day) {
                    const char = CHARACTERS[day.char];
                    
                    // 1. √ârtes√≠t√©s: Sztori reakci√≥ (msgs[0])
                    setTimeout(() => {
                         addNotification(char.name, day.msgs[0], char.icon); 
                    }, 400); 

                    // 2. √ârtes√≠t√©s: K√©p k√ºld√©se (msgs[1] bevezet≈ë sz√∂vege)
                    const imageNotifText = `${char.name} k√©pet k√ºld√∂tt!`;
                    setTimeout(() => {
                         addNotification(char.name, imageNotifText, char.icon); 
                    }, 2500); // 2.5s

                    // 3. √ârtes√≠t√©s: Aj√°nd√©k (msgs[msgs.length - 1] -> msgs[3])
                    setTimeout(() => {
                         addNotification(char.name, day.msgs[day.msgs.length - 1], "üéÅ"); 
                    }, 4500); // 4.5s
                }
                state.notifAfterCloseDayId = null;
            }
            
            state.view = newView;
            if (dayId !== null) state.currentDayId = dayId;
            if (newView === 'story') state.storyPage = 1; // √öjra megnyit√°skor mindig 1. oldal
            

            if (newView === 'chatList') {
                ELEMENTS.chatScreenList.classList.add('active');
                ELEMENTS.chatScreenDetail.classList.remove('active');
            } else if (newView === 'chatDetail') {
                ELEMENTS.chatScreenList.classList.add('active');
                ELEMENTS.chatScreenDetail.classList.add('active');
            } else {
                ELEMENTS.chatScreenList.classList.remove('active');
                ELEMENTS.chatScreenDetail.classList.remove('active');
            }
            
            renderApp(); 
        }

        function updateStoryModalPages() {
            const day = STORY_DATA.find(d => d.id === state.currentDayId);
            if (!day) return;

            // Oldal tartalm√°nak be√°ll√≠t√°sa (HTML-ben p tageket gener√°lunk)
            ELEMENTS.storyPage1.innerHTML = day.storyPage1.split('\n').map(p => `<p>${p}</p>`).join('');
            ELEMENTS.storyPage2.innerHTML = day.storyPage2.split('\n').map(p => `<p>${p}</p>`).join('');
            
            // Oldalak megjelen√≠t√©se/elrejt√©se
            ELEMENTS.storyPage1.style.display = state.storyPage === 1 ? 'block' : 'none';
            ELEMENTS.storyPage2.style.display = state.storyPage === 2 ? 'block' : 'none';

            // Navig√°ci√≥s gombok be√°ll√≠t√°sa
            ELEMENTS.storyPrevBtn.disabled = state.storyPage === 1;
            ELEMENTS.storyNextBtn.disabled = state.storyPage === 2;
            
            ELEMENTS.storyPrevBtn.style.opacity = state.storyPage === 1 ? '0.5' : '1';
            ELEMENTS.storyNextBtn.style.opacity = state.storyPage === 2 ? '0.5' : '1';

            // Pontok aktivit√°sa
            ELEMENTS.storyDot1.classList.toggle('active', state.storyPage === 1);
            ELEMENTS.storyDot2.classList.toggle('active', state.storyPage === 2);
        }

        async function callGemini(userMessage, characterKey, context) {
            if (!state.apiKey) return "Most tele a sz√°m bejglivel, de egyet√©rtek! ü•Ø (Offline m√≥d)";
            
            const char = CHARACTERS[characterKey];
            const systemPrompt = `You are ${char.name}, a ${char.desc}. You are texting your owner 'Mama'. Style: ${char.style}. Context: ${context}. Reply to: "${userMessage}". Keep it short (max 2 sentences), cute, funny. End with a goodbye reason. Language: Hungarian.`;

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${state.apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: systemPrompt }] }],
                generationConfig: { temperature: 0.7 }
            };

            try {
                const response = await fetch(url, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });
                const data = await response.json();
                if(!response.ok || !data.candidates || data.candidates.length === 0) {
                    throw new Error(data.error?.message || "API Error: No response candidate");
                }
                return data.candidates[0].content.parts[0].text;
            } catch (e) {
                console.error("Gemini hiba:", e);
                return "Most tele a sz√°m bejglivel, de egyet√©rtek! ü•Ø (Offline m√≥d)";
            }
        }

        function handleDayClick(day) {
            const today = state.testMode ? 31 : new Date().getDate();
            const isAvailable = day.id <= today;
            
            if (isAvailable) {
                if (!state.unlockedDays.includes(day.id)) {
                    const newUnlocked = [...state.unlockedDays, day.id];
                    saveState('unlockedDays', newUnlocked);
                    
                    // √öJ √úZENET STRUKT√öRA GENER√ÅL√ÅSA
                    const initialMsgs = [];
                    // 1. Sz√∂veg (Sztori reakci√≥)
                    initialMsgs.push({ text: day.msgs[0], isMe: false });
                    
                    // 2. K√©p bevezet≈ë (storyImageText)
                    initialMsgs.push({ text: day.storyImageText, isMe: false, isImageText: true });
                    
                    // 3. K√©p (Pl√©szh√≥lder)
                    initialMsgs.push({ text: `<img src="${day.storyImageUrl}" alt="K√©p a t√∂rt√©netr≈ël">`, isMe: false, isImage: true });

                    // 4. Aj√°nd√©k Sz√∂veg
                    initialMsgs.push({ text: day.msgs[1], isMe: false });
                    
                    const newHist = { ...state.chatHistory, [day.id]: { msgs: initialMsgs, seen: false } };
                    saveState('chatHistory', newHist);
                    
                    state.notifAfterCloseDayId = day.id;
                }
                
                ELEMENTS.storyTitle.textContent = 'üìú ' + day.title;
                setView('story', day.id);
            } else {
                addNotification("Rendszer", "M√©g nem szabad! ü§´", "üîí");
            }
        }
        
        async function sendMessage(text) {
            const trimmedText = text.trim();
            if (!trimmedText || state.typing || !state.currentDayId) return;

            const dayId = state.currentDayId;
            const day = STORY_DATA.find(d => d.id === dayId);
            if (!day) return;

            let currentHist = state.chatHistory[dayId] || { msgs: [] };

            // 1. Saj√°t √ºzenet hozz√°ad√°sa
            const userMessage = { text: trimmedText, isMe: true };
            const msgsAfterUser = [...currentHist.msgs, userMessage];
            
            saveState('chatHistory', { ...state.chatHistory, [dayId]: { ...currentHist, msgs: msgsAfterUser, seen: true } });
            
            ELEMENTS.chatInput.value = ""; 
            ELEMENTS.chatSendCircle.classList.add('disabled');
            
            // 2. Typing √°llapot be√°ll√≠t√°sa √©s UI friss√≠t√©s
            state.typing = true;
            renderChatDetail();
            
            // 3. AI h√≠v√°s (k√©sleltetve)
            await new Promise(r => setTimeout(r, 1500)); 
            
            // Az AI a hossz√∫ sztori reakci√≥ra v√°laszol
            const context = `Mese: ${day.storyPage1.substring(0, 75)}... ${day.storyPage2.substring(0, 75)}... Aj√°nd√©k: ${day.msgs[day.msgs.length - 1]}`;
            const response = await callGemini(trimmedText, day.char, context);
            
            // 4. Typing √°llapot kikapcsol√°sa
            state.typing = false;
            
            // 5. AI v√°lasz hozz√°ad√°sa (a leg√∫jabb nap history-j√°hoz)
            const finalMsgs = [...msgsAfterUser, { text: response, isMe: false }];
            const finalHist = { ...state.chatHistory, [dayId]: { msgs: finalMsgs, seen: true } };
            
            saveState('chatHistory', finalHist);
        }

        // --- RENDER F√úGGV√âNYEK ---

        function createSnowflake() {
            const snowflakeEl = document.createElement('div');
            snowflakeEl.className = 'snowflake';
            snowflakeEl.style.left = Math.random() * 100 + '%';
            snowflakeEl.style.animationDuration = (Math.random() * 5 + 3) + 's';
            snowflakeEl.style.width = Math.random() * 4 + 2 + 'px';
            snowflakeEl.style.height = Math.random() * 4 + 2 + 'px';
            document.querySelector('.app-screen').appendChild(snowflakeEl);
            setTimeout(() => snowflakeEl.remove(), (Math.random() * 5 + 8) * 1000); 
        }

        function updateCountdown() {
            const target = new Date("Dec 24, 2025 18:00:00").getTime();
            const diff = target - new Date().getTime();
            if (diff > 0) {
                const d = Math.floor(diff / (86400000));
                ELEMENTS.countdown.textContent = `M√©g ${d} nap kar√°csonyig`;
            } else {
                ELEMENTS.countdown.textContent = "BOLDOG KAR√ÅCSONYT!";
                clearInterval(countdownInterval);
            }
        }
        
        function renderGrid() {
            ELEMENTS.gridContainer.innerHTML = ''; 
            const today = state.testMode ? 31 : new Date().getDate();
            
            STORY_DATA.forEach(day => {
                const isOpen = state.unlockedDays.includes(day.id);
                const isLocked = day.id > today && !isOpen && !state.testMode;
                
                const cardEl = document.createElement('div');
                cardEl.className = `day-card ${isOpen ? 'opened' : ''} ${isLocked ? 'locked' : ''}`;
                cardEl.onclick = () => handleDayClick(day);
                
                cardEl.innerHTML = isOpen 
                    ? `<div class="status-icon">üéÅ</div>` 
                    : `<div class="day-num">${day.id}</div>`;
                
                if (isLocked) {
                    cardEl.innerHTML += `<div style="position:absolute; bottom:5px; font-size:10px;">üîí</div>`;
                }
                
                ELEMENTS.gridContainer.appendChild(cardEl);
            });
        }
        
        /** Kirajzolja a Chat List√°t (Egy bejegyz√©s/szerepl≈ë) */
        function renderChatList() {
            ELEMENTS.chatListBody.innerHTML = '';
            let totalUnread = 0;
            
            // V√©gigmegy√ºnk a CHAT KONTAKTAINKON (Hanna, Herold, Buck√≥)
            CHAT_CONTACTS.forEach(contact => {
                // Keress√ºk az √∂sszes olyan napot, amit ez a karakter ind√≠tott, √©s ki van nyitva.
                const charDays = STORY_DATA.filter(d => 
                    d.char === contact.key && state.unlockedDays.includes(d.id)
                ).sort((a, b) => b.id - a.id); // Rendez√©s a leg√∫jabb nap szerint

                if (charDays.length === 0) return;
                
                let isUnread = false;
                let lastMsg = 'Nincs √ºzenet';
                let latestDayId = charDays[0].id; // Ez a legfrissebb kinyitott nap
                
                // Mivel az √ºzenetek id≈ërendben vannak a chat detailben, itt a legfrissebb nap √ºzeneteit n√©zz√ºk meg, hogy mi a legut√≥bbi
                const latestHist = state.chatHistory[latestDayId] || { msgs: [] };

                // Olvasatlan √°llapot ellen≈ërz√©se az √ñSSZES napra
                for (const day of charDays) {
                    const hist = state.chatHistory[day.id] || { msgs: [] };
                    if (!hist.seen) {
                        isUnread = true;
                        totalUnread++;
                    }
                }
                
                // Utols√≥ √ºzenet meghat√°roz√°sa
                if (latestHist.msgs.length > 0) {
                    const last = latestHist.msgs[latestHist.msgs.length - 1];
                    lastMsg = (last.isMe ? '√ân: ' : '') + last.text;
                } else if (charDays[0].msgs.length > 0) {
                    // Ha nincs interakci√≥, a kezdeti √ºzenetet vessz√ºk. Az els≈ë hossz√∫ √ºzenet
                    lastMsg = charDays[0].msgs[0]; 
                }
                
                const listItem = document.createElement('div');
                // Kattint√°sra a legfrissebb nap ID-j√©t adjuk √°t, ami alapj√°n a renderChatDetail azonos√≠tja a karaktert
                listItem.onclick = () => setView('chatDetail', latestDayId); 
                listItem.style.cssText = 'display:flex; gap:15px; padding:15px; border-bottom:1px solid #222; cursor:pointer;';
                
                listItem.innerHTML = `
                    <div style="font-size:30px;">${contact.icon}</div>
                    <div style="flex:1;">
                        <div style="display:flex; justify-content:space-between;"><span style="font-weight:bold; color:white;">${contact.name}</span><span style="color:#666; font-size:14px;">Ma</span></div>
                        <div style="color:${isUnread ? 'white' : '#888'}; font-size:15px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; width:250px; font-weight:${isUnread ? 'bold' : 'normal'};">${lastMsg}</div>
                    </div>
                    ${isUnread ? '<div style="width:10px; height:10px; border-radius:50%; background:#007AFF; alignSelf:center;"></div>' : ''}
                `;
                ELEMENTS.chatListBody.appendChild(listItem);
            });
            
            ELEMENTS.unreadBadge.textContent = totalUnread;
            ELEMENTS.unreadBadge.style.display = totalUnread > 0 ? 'flex' : 'none';
        }

        /** Kirajzolja a Chat Detailt */
        function renderChatDetail() {
            const dayId = state.currentDayId;
            if (!dayId) return;

            const selectedDay = STORY_DATA.find(d => d.id === dayId);
            if (!selectedDay) return;

            const char = CHARACTERS[selectedDay.char];

            // √ñSSZEF≈∞Z√âS: Megkeress√ºk az √∂sszes kinyitott napot, amit EZ a karakter ind√≠tott
            const allCharDays = STORY_DATA
                .filter(d => d.char === selectedDay.char && state.unlockedDays.includes(d.id))
                .sort((a, b) => a.id - b.id); // Id≈ërendben, a legr√©gebbit≈ël az √∫jabb fel√©

            let allMessages = [];
            let shouldMarkAsSeen = false;

            for (const day of allCharDays) {
                const hist = state.chatHistory[day.id] || { msgs: [] };
                
                // Rendszer√ºzenet (nap c√≠me)
                allMessages.push({ 
                    text: `iMessage ‚Ä¢ ${day.title}`, 
                    isSystem: true 
                });

                // Hozz√°adjuk a nap √ºzeneteit
                allMessages = allMessages.concat(hist.msgs);

                // Ha az adott nap olvasatlan, be√°ll√≠tjuk a ment√©shez
                if (!hist.seen) {
                    shouldMarkAsSeen = true;
                    // IDEIGLENESEN be√°ll√≠tjuk az √°llapotban, hogy a renderel√©s azonnal l√°ssa
                    state.chatHistory[day.id] = { ...hist, seen: true }; 
                }
            }

            // Fejl√©c friss√≠t√©se
            ELEMENTS.chatDetailIcon.textContent = char.icon;
            ELEMENTS.chatDetailName.textContent = char.name;

            // √úzenetek kirajzol√°sa
            ELEMENTS.chatDetailBody.innerHTML = '';
            
            allMessages.forEach(msg => {
                if(msg.isSystem) {
                    ELEMENTS.chatDetailBody.innerHTML += `<div style="text-align:center; color:#666; font-size:11px; margin:10px 0;">${msg.text}</div>`;
                    return;
                }

                const msgRow = document.createElement('div');
                msgRow.className = `message-row ${msg.isMe ? 'me' : 'them'}`;
                
                const avatarHtml = !msg.isMe ? `<div class="avatar-small">${char.icon}</div>` : '';
                
                let bubbleClass = 'bubble';
                if (msg.isImage) bubbleClass += ' image-bubble';
                
                const contentHtml = msg.isImage ? msg.text : msg.text;
                
                const bubbleHtml = `<div class="bubble ${msg.isMe ? 'me' : 'them'} ${msg.isImage ? 'image-bubble' : ''}">${contentHtml}</div>`;
                
                msgRow.innerHTML = msg.isMe ? bubbleHtml : avatarHtml + bubbleHtml;
                ELEMENTS.chatDetailBody.appendChild(msgRow);
            });

            // Typing Indicator
            const typingEl = ELEMENTS.chatDetailBody.querySelector('.typing-indicator-row');
            
            if (state.typing && !typingEl) {
                const typingRow = document.createElement('div');
                typingRow.className = 'message-row them typing-indicator-row'; 
                typingRow.innerHTML = `
                    <div class="avatar-small">${char.icon}</div>
                    <div class="typing-bubble">
                        <div class="dot"></div><div class="dot"></div><div class="dot"></div>
                    </div>`;
                ELEMENTS.chatDetailBody.appendChild(typingRow);
            } else if (!state.typing && typingEl) {
                 typingEl.remove();
            }

            // Scroll az alj√°ra (FLUIDIT√ÅS)
            ELEMENTS.chatDetailBody.scrollTop = ELEMENTS.chatDetailBody.scrollHeight;
            
            // Gyorsv√°lasz csipek (a legutols√≥ nap √ºzenetei alatt)
            const latestHist = state.chatHistory[selectedDay.id] || { msgs: [] };
            const hasSentMessageToLatestDay = latestHist.msgs.some(m => m.isMe);
            
            if (!hasSentMessageToLatestDay && selectedDay.replies && selectedDay.replies.length > 0) {
                ELEMENTS.replyChips.style.display = 'flex';
                ELEMENTS.replyChips.innerHTML = '';
                selectedDay.replies.forEach(reply => {
                    const chip = document.createElement('div');
                    chip.className = 'chip';
                    chip.textContent = reply.u;
                    chip.onclick = () => sendMessage(reply.u);
                    ELEMENTS.replyChips.appendChild(chip);
                });
            } else {
                ELEMENTS.replyChips.style.display = 'none';
            }

            // Ha olvasatlan volt b√°rmi, mentj√ºk a state-et (friss√≠ti a badge-et)
            if (shouldMarkAsSeen) {
                saveState('chatHistory', state.chatHistory); 
            }
        }
        
        function renderApp() {
            ELEMENTS.apiModal.style.display = state.apiKey ? 'none' : 'flex';
            if (!state.apiKey) return;
            
            ELEMENTS.gridView.style.display = state.view === 'grid' ? 'flex' : 'none';
            ELEMENTS.storyModal.classList.toggle('active', state.view === 'story');
            
            ELEMENTS.tabGrid.classList.toggle('active', state.view === 'grid');
            ELEMENTS.tabChat.classList.toggle('active', state.view === 'chatList' || state.view === 'chatDetail');

            ELEMENTS.chatScreenList.classList.toggle('active', state.view === 'chatList' || state.view === 'chatDetail');
            ELEMENTS.chatScreenDetail.classList.toggle('active', state.view === 'chatDetail');

            if (state.view === 'grid') {
                renderGrid();
                renderChatList(); 
            } else if (state.view === 'story') {
                updateStoryModalPages();
            } else if (state.view === 'chatList') {
                renderChatList();
            } else if (state.view === 'chatDetail') {
                renderChatList();
                renderChatDetail();
            }
            
            // K√ºld≈ë gomb √°llapot friss√≠t√©se
            const hasText = ELEMENTS.chatInput.value.trim().length > 0;
            ELEMENTS.chatSendCircle.classList.toggle('disabled', !hasText || state.typing);
        }

        // --- INICIALIZ√ÅCI√ì √âS ESEM√âNY BE√ÅLL√çT√ÅSOK ---
        
        for(let i=0; i<40; i++) {
            createSnowflake();
        }

        updateCountdown();
        const countdownInterval = setInterval(updateCountdown, 1000);

        ELEMENTS.apiSaveBtn.onclick = () => {
            const key = ELEMENTS.apiInput.value.trim();
            if(key.length > 10) {
                saveState('apiKey', key);
                ELEMENTS.apiModal.style.display = 'none';
                renderApp();
            } else {
                alert("√ârv√©nytelen kulcs!");
            }
        };

        ELEMENTS.tabGrid.onclick = () => setView('grid');
        ELEMENTS.tabChat.onclick = () => setView('chatList');
        
        ELEMENTS.storyModal.onclick = (e) => {
            if (e.target.id === 'story-modal') {
                setView('grid');
            }
        };

        ELEMENTS.storyCloseBtn.onclick = () => {
            setView('grid'); 
        };
        
        // Oldalv√°lt√°s kezel√©se
        ELEMENTS.storyPrevBtn.onclick = () => {
            if (state.storyPage > 1) {
                state.storyPage--;
                renderApp();
            }
        };
        ELEMENTS.storyNextBtn.onclick = () => {
            if (state.storyPage < 2) {
                state.storyPage++;
                renderApp();
            }
        };
        
        document.getElementById('chat-list-close-btn').onclick = () => setView('grid');
        document.getElementById('chat-detail-back-btn').onclick = () => setView('chatList', state.currentDayId);
        
        ELEMENTS.chatInput.oninput = () => {
            const hasText = ELEMENTS.chatInput.value.trim().length > 0;
            ELEMENTS.chatSendCircle.classList.toggle('disabled', !hasText || state.typing);
        };
        ELEMENTS.chatSendCircle.onclick = () => {
            sendMessage(ELEMENTS.chatInput.value);
        };
        ELEMENTS.chatInput.onkeydown = (e) => {
            if (e.key === 'Enter') {
                sendMessage(ELEMENTS.chatInput.value);
            }
        };
        
        document.getElementById('chat-detail-avatar-header').onclick = () => {
            if (navigator.vibrate) navigator.vibrate(50);
            const day = STORY_DATA.find(d => d.id === state.currentDayId);
            if (day) addNotification(CHARACTERS[day.char].name, "H√∫, de j√≥lesett! ‚ù§Ô∏è", "ü•∞");
        };

        ELEMENTS.testBtn.onclick = () => {
            state.testMode = !state.testMode;
            addNotification("Rendszer", `Teszt M√≥d: ${state.testMode ? 'BE' : 'KI'}`, "‚öôÔ∏è");
            renderApp();
        }

        window.onload = renderApp;
    </script>
</body>
</html>
