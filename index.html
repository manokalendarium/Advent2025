<!DOCTYPE html>
<html lang="hu">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <title>Mama KalendÃ¡riuma</title>
Â  Â Â 
Â  Â  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
Â  Â  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
Â  Â  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

Â  Â  <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;500;700&display=swap" rel="stylesheet">
Â  Â  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
Â  Â Â 
Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --ios-blue: #007AFF;
Â  Â  Â  Â  Â  Â  --ios-gray: #262629;
Â  Â  Â  Â  Â  Â  --ios-bg: #000000;
Â  Â  Â  Â  Â  Â  --ios-text: #FFFFFF;
Â  Â  Â  Â  Â  Â  --ios-gray-text: #8E8E93;
Â  Â  Â  Â  Â  Â  --glass: rgba(30, 30, 30, 0.6);
Â  Â  Â  Â  Â  Â  --glass-border: rgba(255, 255, 255, 0.15);
Â  Â  Â  Â  Â  Â  --royal-gold: #FFD700;
Â  Â  Â  Â  }

Â  Â  Â  Â  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
Â  Â  Â  Â  body {Â 
Â  Â  Â  Â  Â  Â  margin: 0; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
Â  Â  Â  Â  Â  Â  background: #000; color: white; overflow: hidden; height: 100vh; width: 100vw;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- HÃTTÃ‰R & EFFEKTEK --- */
Â  Â  Â  Â  .background {
Â  Â  Â  Â  Â  Â  position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
Â  Â  Â  Â  Â  Â  background: radial-gradient(circle at top left, #1a1a2e, #000);
Â  Â  Â  Â  }
Â  Â  Â  Â  .orb {
Â  Â  Â  Â  Â  Â  position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.4;
Â  Â  Â  Â  Â  Â  animation: float 15s infinite ease-in-out alternate;
Â  Â  Â  Â  }
Â  Â  Â  Â  .orb-1 { width: 300px; height: 300px; background: #007AFF; top: -50px; left: -50px; }
Â  Â  Â  Â  .orb-2 { width: 400px; height: 400px; background: #5E5CE6; bottom: -100px; right: -100px; animation-delay: -5s; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes float { 0% { transform: translate(0,0); } 100% { transform: translate(40px, 60px); } }

Â  Â  Â  Â  /* HÃ“ESÃ‰S */
Â  Â  Â  Â  .snowflake { position: absolute; background: white; border-radius: 50%; opacity: 0.7; pointer-events: none; animation: fall linear infinite; }
Â  Â  Â  Â  @keyframes fall { to { transform: translateY(105vh); } }

Â  Â  Â  Â  /* --- FÅ TARTÃLY --- */
Â  Â  Â  Â  #root { height: 100%; display: flex; justify-content: center; }
Â  Â  Â  Â  .app-screen {
Â  Â  Â  Â  Â  Â  width: 100%; max-width: 480px; height: 100%;Â 
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; position: relative;
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.2);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- HEADER --- */
Â  Â  Â  Â  .header {
Â  Â  Â  Â  Â  Â  padding: 20px; text-align: center; position: relative; z-index: 10;
Â  Â  Â  Â  }
Â  Â  Â  Â  .app-title {
Â  Â  Â  Â  Â  Â  font-size: 12px; letter-spacing: 2px; text-transform: uppercase; color: rgba(255,255,255,0.5); margin-bottom: 5px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .main-title {
Â  Â  Â  Â  Â  Â  font-size: 28px; font-weight: 800;
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #fff, #ccc); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
Â  Â  Â  Â  Â  Â  text-shadow: 0 4px 20px rgba(255,255,255,0.3);
Â  Â  Â  Â  }
Â  Â  Â  Â  .countdown {
Â  Â  Â  Â  Â  Â  font-family: monospace; font-size: 11px; background: rgba(255,255,255,0.1);Â 
Â  Â  Â  Â  Â  Â  padding: 4px 8px; border-radius: 6px; display: inline-block; margin-top: 8px;
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255,255,255,0.1); color: var(--royal-gold);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- GRID (NAPTÃR) --- */
Â  Â  Â  Â  .grid-container {
Â  Â  Â  Â  Â  Â  flex: 1; overflow-y: auto; padding: 20px;
Â  Â  Â  Â  Â  Â  display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;
Â  Â  Â  Â  Â  Â  align-content: start;
Â  Â  Â  Â  }
Â  Â  Â  Â  .grid-container::-webkit-scrollbar { display: none; }

Â  Â  Â  Â  .day-card {
Â  Â  Â  Â  Â  Â  aspect-ratio: 1;
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.08);
Â  Â  Â  Â  Â  Â  border-radius: 18px;
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.1);
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; align-items: center; justify-content: center;
Â  Â  Â  Â  Â  Â  position: relative; cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
Â  Â  Â  Â  }
Â  Â  Â  Â  .day-card:active { transform: scale(0.92); background: rgba(255,255,255,0.15); }
Â  Â  Â  Â  .day-card.locked { opacity: 0.4; background: rgba(0,0,0,0.3); border-color: rgba(255,255,255,0.05); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .day-num { font-size: 20px; font-weight: 700; }
Â  Â  Â  Â  .status-icon { font-size: 24px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .day-card.opened {
Â  Â  Â  Â  Â  Â  background: rgba(0, 122, 255, 0.2);
Â  Â  Â  Â  Â  Â  border-color: rgba(0, 122, 255, 0.5);
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 20px rgba(0, 122, 255, 0.3);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- ALSÃ“ TAB BAR --- */
Â  Â  Â  Â  .tab-bar {
Â  Â  Â  Â  Â  Â  background: rgba(20, 20, 20, 0.85); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
Â  Â  Â  Â  Â  Â  border-top: 1px solid rgba(255,255,255,0.1);
Â  Â  Â  Â  Â  Â  padding: 10px 30px 30px 30px;
Â  Â  Â  Â  Â  Â  display: flex; justify-content: space-around;
Â  Â  Â  Â  }
Â  Â  Â  Â  .tab-item {
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; align-items: center; gap: 4px;
Â  Â  Â  Â  Â  Â  color: #888; cursor: pointer; transition: color 0.2s; position: relative;
Â  Â  Â  Â  }
Â  Â  Â  Â  .tab-item.active { color: #007AFF; }
Â  Â  Â  Â  .tab-icon { font-size: 24px; }
Â  Â  Â  Â  .tab-label { font-size: 10px; font-weight: 500; }
Â  Â  Â  Â  .badge {
Â  Â  Â  Â  Â  Â  position: absolute; top: -2px; right: -5px;
Â  Â  Â  Â  Â  Â  background: #FF3B30; color: white; font-size: 10px; font-weight: bold;
Â  Â  Â  Â  Â  Â  min-width: 16px; height: 16px; border-radius: 8px;
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; justify-content: center; padding: 2px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- MESE MODAL --- */
Â  Â  Â  Â  .modal-overlay {
Â  Â  Â  Â  Â  Â  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  z-index: 50; display: flex; align-items: center; justify-content: center;
Â  Â  Â  Â  Â  Â  animation: fadeIn 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .story-card {
Â  Â  Â  Â  Â  Â  width: 85%; max-height: 70%; background: #1C1C1E;
Â  Â  Â  Â  Â  Â  border-radius: 24px; padding: 24px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 20px 50px rgba(0,0,0,0.8);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255,255,255,0.1);
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column;
Â  Â  Â  Â  Â  Â  animation: scaleUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
Â  Â  Â  Â  }
Â  Â  Â  Â  .story-title { font-size: 22px; font-weight: 700; margin-bottom: 15px; color: white; text-align: center; }
Â  Â  Â  Â  .story-text { font-size: 17px; line-height: 1.5; color: #ddd; overflow-y: auto; flex: 1; margin-bottom: 20px; font-family: "Times New Roman", serif; }
Â  Â  Â  Â  .story-btn {
Â  Â  Â  Â  Â  Â  background: #007AFF; color: white; border: none; padding: 14px;
Â  Â  Â  Â  Â  Â  border-radius: 14px; font-size: 17px; font-weight: 600; width: 100%; cursor: pointer;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- API KULCS MODAL --- */
Â  Â  Â  Â  .api-modal {
Â  Â  Â  Â  Â  Â  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
Â  Â  Â  Â  Â  Â  background: #000; z-index: 999; display: flex; align-items: center; justify-content: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .api-card {
Â  Â  Â  Â  Â  Â  width: 85%; background: #1C1C1E; padding: 30px; border-radius: 24px; text-align: center; border: 1px solid #333;
Â  Â  Â  Â  }
Â  Â  Â  Â  .api-input {
Â  Â  Â  Â  Â  Â  width: 100%; padding: 12px; margin: 15px 0; background: #2C2C2E; border: 1px solid #444; border-radius: 12px; color: white; font-size: 16px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- iMESSAGE CHAT --- */
Â  Â  Â  Â  .chat-screen {
Â  Â  Â  Â  Â  Â  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
Â  Â  Â  Â  Â  Â  background: #000; z-index: 100;
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column;
Â  Â  Â  Â  Â  Â  animation: slideLeft 0.3s ease-out;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .chat-header {
Â  Â  Â  Â  Â  Â  background: rgba(20, 20, 20, 0.85); backdrop-filter: blur(20px);
Â  Â  Â  Â  Â  Â  padding: 15px 10px; display: flex; align-items: center;
Â  Â  Â  Â  Â  Â  border-bottom: 1px solid rgba(255,255,255,0.1); z-index: 20;
Â  Â  Â  Â  }
Â  Â  Â  Â  .back-btn { color: #007AFF; font-size: 17px; display: flex; align-items: center; gap: 5px; cursor: pointer; }
Â  Â  Â  Â  .chat-avatar-header {
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; align-items: center; flex: 1; margin-right: 40px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .header-avatar { font-size: 24px; margin-bottom: 2px; transition: transform 0.2s; cursor: pointer; }
Â  Â  Â  Â  .header-avatar:active { transform: scale(1.2); }
Â  Â  Â  Â  .header-name { font-size: 12px; color: #fff; font-weight: 500; }

Â  Â  Â  Â  .chat-body {
Â  Â  Â  Â  Â  Â  flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 8px;
Â  Â  Â  Â  Â  Â  padding-bottom: 80px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .message-row { display: flex; width: 100%; margin-bottom: 4px; }
Â  Â  Â  Â  .message-row.me { justify-content: flex-end; }
Â  Â  Â  Â  .message-row.them { justify-content: flex-start; align-items: flex-end; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .avatar-small { width: 30px; height: 30px; border-radius: 50%; background: #333; display: flex; align-items: center; justify-content: center; font-size: 16px; margin-right: 8px; }

Â  Â  Â  Â  .bubble {
Â  Â  Â  Â  Â  Â  max-width: 75%; padding: 10px 16px; font-size: 17px; line-height: 1.4; position: relative;
Â  Â  Â  Â  }
Â  Â  Â  Â  .bubble.me {
Â  Â  Â  Â  Â  Â  background: #007AFF; color: white; border-radius: 20px 20px 4px 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .bubble.them {
Â  Â  Â  Â  Â  Â  background: #262628; color: white; border-radius: 20px 20px 20px 4px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .chat-input-bar {
Â  Â  Â  Â  Â  Â  position: absolute; bottom: 0; width: 100%;
Â  Â  Â  Â  Â  Â  background: rgba(20, 20, 20, 0.9); backdrop-filter: blur(20px);
Â  Â  Â  Â  Â  Â  padding: 10px 15px 30px 15px; border-top: 1px solid rgba(255,255,255,0.1);
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; gap: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .ios-input {
Â  Â  Â  Â  Â  Â  flex: 1; background: #1C1C1E; border: 1px solid #333;
Â  Â  Â  Â  Â  Â  border-radius: 20px; padding: 8px 15px; color: white; font-size: 17px; outline: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  .send-circle {
Â  Â  Â  Â  Â  Â  width: 30px; height: 30px; background: #007AFF; border-radius: 50%;
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; justify-content: center; color: white; font-size: 16px; cursor: pointer;
Â  Â  Â  Â  }
Â  Â  Â  Â  .send-circle.disabled { background: #444; color: #888; }

Â  Â  Â  Â  /* TYPING INDICATOR */
Â  Â  Â  Â  .typing-bubble {
Â  Â  Â  Â  Â  Â  background: #262628; padding: 12px 16px; border-radius: 20px; width: fit-content;
Â  Â  Â  Â  Â  Â  display: flex; gap: 4px; align-items: center; margin-left: 38px; border-bottom-left-radius: 4px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .dot { width: 6px; height: 6px; background: #8E8E93; border-radius: 50%; animation: bounce 1.4s infinite ease-in-out both; }
Â  Â  Â  Â  .dot:nth-child(1) { animation-delay: -0.32s; } .dot:nth-child(2) { animation-delay: -0.16s; }
Â  Â  Â  Â  @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }

Â  Â  Â  Â  /* iOS NOTIFICATION */
Â  Â  Â  Â  .ios-notification {
Â  Â  Â  Â  Â  Â  position: absolute; top: 10px; left: 10px; right: 10px;
Â  Â  Â  Â  Â  Â  background: rgba(30, 30, 30, 0.85); backdrop-filter: blur(25px);
Â  Â  Â  Â  Â  Â  border-radius: 18px; padding: 12px;
Â  Â  Â  Â  Â  Â  display: flex; gap: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.5);
Â  Â  Â  Â  Â  Â  z-index: 200; cursor: pointer;
Â  Â  Â  Â  Â  Â  animation: notifSlide 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255,255,255,0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  .notif-icon {
Â  Â  Â  Â  Â  Â  width: 40px; height: 40px; background: #333; border-radius: 10px;
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; justify-content: center; font-size: 22px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .notif-content { flex: 1; }
Â  Â  Â  Â  .notif-header { display: flex; justify-content: space-between; margin-bottom: 2px; }
Â  Â  Â  Â  .notif-title { font-weight: 600; font-size: 14px; color: white; }
Â  Â  Â  Â  .notif-msg { font-size: 14px; color: #fff; line-height: 1.2; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

Â  Â  Â  Â  @keyframes notifSlide { from { transform: translateY(-100px); } to { transform: translateY(0); } }
Â  Â  Â  Â  @keyframes slideLeft { from { transform: translateX(100%); } to { transform: translateX(0); } }
Â  Â  Â  Â  @keyframes scaleUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
Â  Â  Â  Â  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

Â  Â  Â  Â  .reply-chips { display: flex; gap: 8px; padding: 10px 15px; overflow-x: auto; }
Â  Â  Â  Â  .chip { background: #1C1C1E; color: #007AFF; border: 1px solid #007AFF; padding: 8px 16px; border-radius: 20px; font-size: 15px; white-space: nowrap; cursor: pointer; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .test-btn { position: absolute; top: 20px; left: 20px; font-size: 24px; opacity: 0.3; cursor: pointer; z-index: 10; }
Â  Â  </style>
</head>
<body>
Â  Â  <div id="root"></div>

Â  Â  <script type="text/babel">
Â  Â  Â  Â  const { useState, useEffect, useRef, useLayoutEffect } = React;

Â  Â  Â  Â  // --- ADATOK ---
Â  Â  Â  Â  const characters = {
Â  Â  Â  Â  Â  Â  hanna: { name: "Hanna", icon: "ğŸ€", desc: "rÃ³zsaszÃ­n, gondoskodÃ³ lÃ¡ny vÃ­zilÃ³", style: "Kedves, anyÃ¡skodÃ³, sok emojit hasznÃ¡l." },
Â  Â  Â  Â  Â  Â  herold: { name: "Herold", icon: "ğŸ¦›", desc: "lila, pufÃ³k Ã©s falÃ¡nk vÃ­zilÃ³", style: "Vicces, Ã©hes, szeleburdi." },
Â  Â  Â  Â  Â  Â  bucko: { name: "BuckÃ³", icon: "ğŸ³", desc: "kÃ©k, bÃ¡tor kis bÃ¡lna", style: "BÃ¡tor, lelkes, vizet emleget." }
Â  Â  Â  Â  };

Â  Â  Â  Â  const storyData = [
Â  Â  Â  Â  Â  Â  { id: 1, title: "A nagy elutazÃ¡s", message: "A reggel kÃ¶dÃ¶sen indult... Papa Ã©s Mama elindultak. Herold cocÃ³ az ablakban Ã¡llt. 'Ne itasd az egereket!' â€“ mondta Hanna. BuckÃ³ tÃ©sztaszÅ±rÅ‘vel a fejÃ©n tisztelgett.", char: "hanna", msgs: ["Szia Mama! â¤ï¸ Ne aggÃ³dj Ã©rtÃ¼nk, nagyon Ã¼gyesek vagyunk itt otthon! Herold mÃ¡r nem is sÃ­r. VigyÃ¡zz magadra! Puszilunk!", "KÃ©szÃ­tettem neked egy kis csomagot az Ãºtra. HasznÃ¡ld ezt a Mini kÃ©zkrÃ©met, hogy puha maradjon a kezed!"], replies: [{u: "KÃ¶szÃ¶nÃ¶m, Hanna! â¤ï¸", c: "SzÃ­vesen! Most megyek, segÃ­tek Heroldnak kipakolni. Szia! ğŸ‘‹"}, {u: "Ti is vigyÃ¡zzatok!", c: "ÃgÃ©rjÃ¼k! Na szaladok, mert BuckÃ³ beszorult. Szia!"}] },
Â  Â  Â  Â  Â  Â  { id: 2, title: "ElsÅ‘ este", message: "Furcsa csend. BuckÃ³ a kÃ¡dban aludt, mert hiÃ¡nyzott neki a tenger. A tÃ¶bbiek a szÅ‘nyegen kempingeztek. 'Ha betÃ¶rÅ‘ jÃ¶n, csapkodni fogok!'", char: "bucko", msgs: ["Jelentem: a hÃ¡z biztonsÃ¡gos! A fÃ¼rdÅ‘kÃ¡dban alszom, onnan mindent hallok. ğŸ³", "Hogy te is nyugodtan aludj, kÃ¼ldÃ¶k neked egy kis LevendulÃ¡s pÃ¡rnapermentet. SzÃ©p Ã¡lmokat!"], replies: [{u: "JÃ³ Ã©jt, BuckÃ³! ğŸŒ™", c: "Neked is! Megyek csobbanok egyet. SzÃ©p Ã¡lmokat! ğŸ›"}, {u: "BÃ¡tor vagy!", c: "KÃ¶szi! De most bebÃºjok a habok alÃ¡. Szia! ğŸ«§"}] },
Â  Â  Â  Â  Â  Â  // ... GenerÃ¡ljuk a tÃ¶bbit a pÃ©lda kedvÃ©Ã©rt
Â  Â  Â  Â  ];

Â  Â  Â  Â  for(let i=3; i<=24; i++) {
Â  Â  Â  Â  Â  Â  storyData.push({ id: i, title: `${i}. Nap`, message: "A tÃ¶rtÃ©net hamarosan Ã©rkezik...", char: "herold", msgs: ["Szia Mama! MÃ©g kÃ©szÃ¼lÃ¼nk!", "Itt egy kis szeretet csomag neked!"], replies: [{u: "KÃ¶szi!", c: "Puszi!"}] });
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- AI SERVICE (GEMINI 2.0 FLASH) - BIZTONSÃGOS KULCSKEZELÃ‰S ---
Â  Â  Â  Â  async function callGemini(apiKey, userMessage, characterKey, context) {
Â  Â  Â  Â  Â  Â  const char = characters[characterKey];
Â  Â  Â  Â  Â  Â  const systemPrompt = `You are ${char.name}, a ${char.desc}. You are texting your owner 'Mama'. Style: ${char.style}. Context: ${context}. Reply to: "${userMessage}". Keep it short (max 2 sentences), cute, funny. End with a goodbye reason. Language: Hungarian.`;

Â  Â  Â  Â  Â  Â  const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${apiKey}`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const payload = {
Â  Â  Â  Â  Â  Â  Â  Â  contents: [{ parts: [{ text: systemPrompt }] }],
Â  Â  Â  Â  Â  Â  Â  Â  generationConfig: { temperature: 0.7 }
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(url, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/json" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(payload)
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  const data = await response.json();
Â  Â  Â  Â  Â  Â  Â  Â  if(!response.ok) throw new Error(data.error?.message || "API Error");
Â  Â  Â  Â  Â  Â  Â  Â  return data.candidates[0].content.parts[0].text;
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error(e);
Â  Â  Â  Â  Â  Â  Â  Â  return "Most tele a szÃ¡m bejglivel, de egyetÃ©rtek! ğŸ¥¯ (Offline mÃ³d)";
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- APP COMPONENT ---
Â  Â  Â  Â  function App() {
Â  Â  Â  Â  Â  Â  // --- KULCS KEZELÃ‰S ---
Â  Â  Â  Â  Â  Â  const [apiKey, setApiKey] = useState(() => localStorage.getItem('geminiKey') || "");
Â  Â  Â  Â  Â  Â  const [showKeyModal, setShowKeyModal] = useState(false);
Â  Â  Â  Â  Â  Â  const [tempKey, setTempKey] = useState("");

Â  Â  Â  Â  Â  Â  useEffect(() => { if(!apiKey) setShowKeyModal(true); }, [apiKey]);

Â  Â  Â  Â  Â  Â  const saveKey = () => {
Â  Â  Â  Â  Â  Â  Â  Â  if(tempKey.length > 10) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('geminiKey', tempKey);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setApiKey(tempKey);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setShowKeyModal(false);
Â  Â  Â  Â  Â  Â  Â  Â  } else alert("Ã‰rvÃ©nytelen kulcs!");
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  // Ãllapotok
Â  Â  Â  Â  Â  Â  const [unlockedDays, setUnlockedDays] = useState(() => JSON.parse(localStorage.getItem('openedDays')) || []);
Â  Â  Â  Â  Â  Â  const [chatHistory, setChatHistory] = useState(() => JSON.parse(localStorage.getItem('chatHistory3')) || {});
Â  Â  Â  Â  Â  Â  const [view, setView] = useState('grid'); // 'grid', 'story', 'chatList', 'chatDetail'
Â  Â  Â  Â  Â  Â  const [currentDay, setCurrentDay] = useState(null);Â 
Â  Â  Â  Â  Â  Â  const [notifications, setNotifications] = useState([]);
Â  Â  Â  Â  Â  Â  const [unreadCount, setUnreadCount] = useState(0);
Â  Â  Â  Â  Â  Â  const [countdown, setCountdown] = useState("");
Â  Â  Â  Â  Â  Â  const [typing, setTyping] = useState(false);
Â  Â  Â  Â  Â  Â  const [inputText, setInputText] = useState("");
Â  Â  Â  Â  Â  Â  const [testMode, setTestMode] = useState(false);
Â  Â  Â  Â  Â  Â  // ÃšJ ÃLLAPOT az Ã©rtesÃ­tÃ©s kÃ©sleltetÃ©sÃ©hez
Â  Â  Â  Â  Â  Â  const [notifAfterCloseDayId, setNotifAfterCloseDayId] = useState(null);

Â  Â  Â  Â  Â  Â  const chatEndRef = useRef(null);

Â  Â  Â  Â  Â  Â  useEffect(() => {
Â  Â  Â  Â  Â  Â  Â  Â  const t = setInterval(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const target = new Date("Dec 24, 2025 18:00:00").getTime();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const diff = target - new Date().getTime();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (diff > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const d = Math.floor(diff / (86400000));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setCountdown(`MÃ©g ${d} nap karÃ¡csonyig`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else setCountdown("BOLDOG KARÃCSONYT!");
Â  Â  Â  Â  Â  Â  Â  Â  }, 1000);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const count = unlockedDays.length - Object.values(chatHistory).filter(c => c.seen).length;
Â  Â  Â  Â  Â  Â  Â  Â  setUnreadCount(Math.max(0, count));
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  return () => clearInterval(t);
Â  Â  Â  Â  Â  Â  }, [unlockedDays, chatHistory]);

Â  Â  Â  Â  Â  Â  // ÃšJ useEffect: Ã‰rtesÃ­tÃ©s megjelenÃ­tÃ©se a 'story' modal bezÃ¡rÃ¡sa UTÃN
Â  Â  Â  Â  Â  Â  useEffect(() => {
Â  Â  Â  Â  Â  Â  Â  Â  if (view === 'grid' && notifAfterCloseDayId !== null) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const day = storyData.find(d => d.id === notifAfterCloseDayId);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (day) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const char = characters[day.char];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ã‰rtesÃ­tÃ©s 1: Karakter Ã¼zenete
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addNotification(char.name, day.msgs[0], char.icon);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ã‰rtesÃ­tÃ©s 2: AjÃ¡ndÃ©k (kis kÃ©sleltetÃ©ssel)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => addNotification(char.name, day.msgs[1], "ğŸ"), 3000);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // TÃ¶rÃ¶ljÃ¼k az Ã¡llapotot, hogy ne jelenjen meg Ãºjra
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setNotifAfterCloseDayId(null);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }, [view, notifAfterCloseDayId]); // Fontos a fÃ¼ggÅ‘sÃ©gek helyes beÃ¡llÃ­tÃ¡sa!

Â  Â  Â  Â  Â  Â  useLayoutEffect(() => {
Â  Â  Â  Â  Â  Â  Â  Â  if(view === 'chatDetail') chatEndRef.current?.scrollIntoView({ behavior: "smooth" });
Â  Â  Â  Â  Â  Â  }, [chatHistory, view, typing]);

Â  Â  Â  Â  Â  Â  const addNotification = (name, msg, icon) => {
Â  Â  Â  Â  Â  Â  Â  Â  const id = Date.now();
Â  Â  Â  Â  Â  Â  Â  Â  setNotifications(prev => [{id, name, msg, icon}, ...prev]);
Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => setNotifications(prev => prev.filter(n => n.id !== id)), 5000);
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  const handleDayClick = (day) => {
Â  Â  Â  Â  Â  Â  Â  Â  const today = new Date().getDate();
Â  Â  Â  Â  Â  Â  Â  Â  const isAvailable = testMode || day.id <= today; // Teszt mÃ³d
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (isAvailable) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!unlockedDays.includes(day.id)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const newUnlocked = [...unlockedDays, day.id];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setUnlockedDays(newUnlocked);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('openedDays', JSON.stringify(newUnlocked));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const initialMsgs = day.msgs.map(m => ({ text: m, isMe: false }));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const newHist = { ...chatHistory, [day.id]: { msgs: initialMsgs, seen: false } };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setChatHistory(newHist);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('chatHistory3', JSON.stringify(newHist));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ELMENTJÃœK AZ AZONOSÃTÃ“T, HOGY A MODAL BEZÃRÃSA UTÃN Ã‰RTESÃTSE
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setNotifAfterCloseDayId(day.id); 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setCurrentDay(day);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setView('story');
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addNotification("Rendszer", "MÃ©g nem szabad! ğŸ¤«", "ğŸ”’");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  const handlePetting = () => {
Â  Â  Â  Â  Â  Â  Â  Â  if (navigator.vibrate) navigator.vibrate(50);
Â  Â  Â  Â  Â  Â  Â  Â  addNotification(characters[currentDay.char].name, "HÃº, de jÃ³lesett! â¤ï¸", "ğŸ¥°");
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  const sendMessage = async (text) => {
Â  Â  Â  Â  Â  Â  Â  Â  if(!text.trim()) return;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const dayId = currentDay.id;
Â  Â  Â  Â  Â  Â  Â  Â  const oldData = chatHistory[dayId] || { msgs: [] };
Â  Â  Â  Â  Â  Â  Â  Â  const newMsgs = [...oldData.msgs, { text, isMe: true }];
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  setChatHistory(prev => ({ ...prev, [dayId]: { ...prev[dayId], msgs: newMsgs } }));
Â  Â  Â  Â  Â  Â  Â  Â  setInputText("");
Â  Â  Â  Â  Â  Â  Â  Â  setTyping(true);

Â  Â  Â  Â  Â  Â  Â  Â  await new Promise(r => setTimeout(r, 2000));Â 
Â  Â  Â  Â  Â  Â  Â  Â  const context = `Mese: ${currentDay.message}. AjÃ¡ndÃ©k: ${currentDay.msgs[1]}`;
Â  Â  Â  Â  Â  Â  Â  Â  const response = await callGemini(apiKey, text, currentDay.char, context); // ITT a kulcs!
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  setTyping(false);
Â  Â  Â  Â  Â  Â  Â  Â  const finalMsgs = [...newMsgs, { text: response, isMe: false }];
Â  Â  Â  Â  Â  Â  Â  Â  const finalHist = { ...chatHistory, [dayId]: { msgs: finalMsgs, seen: true } };
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  setChatHistory(finalHist);
Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('chatHistory3', JSON.stringify(finalHist));
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  // --- RENDER ---
Â  Â  Â  Â  Â  Â  return (
Â  Â  Â  Â  Â  Â  Â  Â  <div className="app-screen">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {/* API MODAL */}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {showKeyModal && (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="api-modal">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="api-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style={{fontSize:'40px'}}>ğŸ”‘</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>Szia!</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>KÃ©rlek add meg a Gemini API kulcsodat, hogy a plÃ¼ssÃ¶k tudjanak beszÃ©lni!</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input className="api-input" placeholder="MÃ¡sold ide a kulcsot..." value={tempKey} onChange={e => setTempKey(e.target.value)} />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button className="story-btn" onClick={saveKey}>MentÃ©s Ã©s IndÃ­tÃ¡s</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )}

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {/* TESZT MÃ“D KAPCSOLÃ“ (Bal felÃ¼l rejtett) */}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="test-btn" onClick={() => setTestMode(!testMode)}>âš™ï¸</div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="background"><div className="orb orb-1"></div><div className="orb orb-2"></div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {[...Array(40)].map((_,i) => <div key={i} className="snowflake" style={{left:Math.random()*100+'%', animationDuration:(Math.random()*5+3)+'s', width:Math.random()*4+2+'px', height:Math.random()*4+2+'px', animationDelay:Math.random()*5+'s'}}></div>)}

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="notification-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {notifications.map(n => (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div key={n.id} className="ios-notification" onClick={() => { setView('chatList'); setNotifications([]); }}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="notif-icon">{n.icon}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="notif-content">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="notif-header"><span className="notif-title">{n.name}</span><span className="notif-time">Most</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="notif-msg">{n.msg}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {view === 'grid' && (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="app-title">MAMA KALENDÃRIUMA</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="main-title">2025</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="countdown">{countdown}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="grid-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {storyData.map(day => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isOpen = unlockedDays.includes(day.id);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isLocked = day.id > new Date().getDate() && !isOpen && !testMode;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div key={day.id} className={`day-card ${isOpen ? 'opened' : ''} ${isLocked ? 'locked' : ''}`} onClick={() => !isLocked && handleDayClick(day)}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {isOpen ? <div className="status-icon">ğŸ</div> : <div className="day-num">{day.id}</div>}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {isLocked && <div style={{position:'absolute', bottom:5, fontSize:10}}>ğŸ”’</div>}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  })}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="tab-bar">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="tab-item active"><i className="bi bi-grid-fill tab-icon"></i><span className="tab-label">NaptÃ¡r</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="tab-item" onClick={() => setView('chatList')}><div style={{position:'relative'}}><i className="bi bi-chat-fill tab-icon"></i>{unreadCount > 0 && <div className="badge">{unreadCount}</div>}</div><span className="tab-label">Ãœzenetek</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )}

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {view === 'story' && currentDay && (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div 
                            className="modal-overlay" 
                            onClick={() => setView('grid')} // A bezÃ¡rÃ¡s vÃ¡ltja ki az Ã©rtesÃ­tÃ©st a useEffect-ben
                        >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="story-card" onClick={e => e.stopPropagation()}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="story-title">ğŸ“œ {currentDay.title}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="story-text">{currentDay.message}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button 
                                    className="story-btn" 
                                    onClick={() => { 
                                        setView('grid'); 
                                        setTimeout(() => setView('chatDetail'), 300); 
                                    }}
                                >
                                    MegnÃ©zem az Ã¼zenetet
                                </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )}

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {view === 'chatList' && (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="chat-screen" style={{background:'black'}}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="chat-header" style={{justifyContent:'center'}}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style={{fontWeight:'bold', fontSize:17}}>Ãœzenetek</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style={{position:'absolute', left:15, color:'#007AFF', cursor:'pointer'}} onClick={() => setView('grid')}>BezÃ¡rÃ¡s</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="chat-body" style={{padding:0}}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {unlockedDays.map(id => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const day = storyData.find(d => d.id === id);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const char = characters[day.char];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const hist = chatHistory[id] || { msgs: [] };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const lastMsg = hist.msgs[hist.msgs.length-1]?.text || "";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div key={id} onClick={() => { setCurrentDay(day); setView('chatDetail'); }} style={{display:'flex', gap:15, padding:15, borderBottom:'1px solid #222', cursor:'pointer'}}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style={{fontSize:30}}>{char.icon}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style={{flex:1}}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style={{display:'flex', justifyContent:'space-between'}}><span style={{fontWeight:'bold'}}>{char.name}</span><span style={{color:'#666', fontSize:14}}>Most</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style={{color:'#888', fontSize:15, overflow:'hidden', textOverflow:'ellipsis', whiteSpace:'nowrap', width:'250px'}}>{lastMsg}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {!hist.seen && <div style={{width:10, height:10, borderRadius:'50%', background:'#007AFF', alignSelf:'center'}}></div>}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  })}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )}

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {view === 'chatDetail' && currentDay && (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="chat-screen">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="chat-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="back-btn" onClick={() => setView('chatList')}><i className="bi bi-chevron-left"></i> Vissza</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="chat-avatar-header" onClick={handlePetting}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="header-avatar">{characters[currentDay.char].icon}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="header-name">{characters[currentDay.char].name}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style={{width:50}}></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="chat-body">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style={{textAlign:'center', color:'#666', fontSize:11, margin:'10px 0'}}>iMessage â€¢ Ma</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {(chatHistory[currentDay.id]?.msgs || []).map((msg, i) => (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div key={i} className={`message-row ${msg.isMe ? 'me' : 'them'}`}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {!msg.isMe && <div className="avatar-small">{characters[currentDay.char].icon}</div>}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className={`bubble ${msg.isMe ? 'me' : 'them'}`}>{msg.text}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {typing && <div className="typing-bubble"><div className="dot"></div><div className="dot"></div><div className="dot"></div></div>}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div ref={chatEndRef} />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {(!chatHistory[currentDay.id]?.msgs.some(m => m.isMe)) && (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="reply-chips">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {currentDay.replies?.map((rep, idx) => (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div key={idx} className="chip" onClick={() => sendMessage(rep.u)}>{rep.u}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="chat-input-bar">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input className="ios-input" placeholder="iMessage" value={inputText} onChange={e => setInputText(e.target.value)} />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className={`send-circle ${!inputText.trim() && !typing ? 'disabled' : ''}`} onClick={() => sendMessage(inputText)}><i className="bi bi-arrow-up"></i></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )}
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  }
Â  Â  Â  Â  const root = ReactDOM.createRoot(document.getElementById('root'));
Â  Â  Â  Â  root.render(<App />);
Â  Â  </script>
</body>
</html>
